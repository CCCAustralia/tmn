Ext.ns("tmn","tmn.view");tmn.view.AuthorisationPanel=function(a,b){this.view=a||{};b=b||{};this.id=b.id||"authorisation_panel";this.title=b.title||"Authorisation Level";this.leader=b.leader||"Your";this.mode=b.mode||"all";this.noNames=b.noNames||false;this.user_id=0;if(!this.noNames){this.nameStore=new Ext.data.JsonStore({itemId:"name_store",root:"data",url:"php/imp/namefill.php",fields:["ID","FIRSTNAME","SURNAME","MINISTRY"],baseParams:{mode:this.mode},autoLoad:true,listeners:{scope:this,load:function(d,c,e){if(c.length==1){this.user_id=c[0].data.ID;if(this.rendered){this.autoSelectName.call(c[0],this)}else{this.on("afterrender",this.autoSelectName,c[0])}}}}})}var b={itemId:this.id,frame:true,header:false,bodyStyle:"padding:0",items:[{xtype:"label",text:"Enter the name of your "+this.leader+" Authoriser:",style:{marginBottom:"10px"}},{itemId:"name",xtype:"compositefield",msgTarget:"side",fieldLabel:"Full Name",items:[{itemId:"first_name",xtype:"combo",flex:1,fieldLabel:"First Name",name:"FIRSTNAME",hiddenName:"FIRSTNAME",hiddenId:"FIRSTNAME_hidden",emptyText:"Authoriser Name...",triggerAction:"all",allowBlank:false,hideTrigger:false,editable:false,forceSelection:true,mode:"local",store:this.nameStore,tpl:'<tpl for="."><div class="x-combo-list-item">{FIRSTNAME} {SURNAME} - {MINISTRY}</div></tpl>',displayField:"FIRSTNAME",valueField:"FIRSTNAME",listeners:{select:function(e,c,d){this.user_id=c.data.ID},scope:this}}]}]};if(this.noNames){b={itemId:this.id,frame:true,header:false,bodyStyle:"padding:0"};this.nameStore=null}tmn.view.AuthorisationPanel.superclass.constructor.call(this,b)};Ext.extend(tmn.view.AuthorisationPanel,Ext.form.FormPanel,{isValid:function(){var a,b=-1;if(!this.noNames){a=this.getForm().items.map.name;if(!this.hidden){b=a.items.findIndexBy(function(d,c){if(d.getValue()==""||d.getValue()==null||d.getValue()===undefined){return true}})}}if(b<0){return true}else{return false}},getData:function(){var a,b={};if(!this.noNames){a=this.getForm().items.map.name;b.user_id=this.user_id}b.reasons={};if(this.reasonArray!==undefined){b.reasons=this.reasonArray}return b},resetFields:function(){if(!this.noNames){this.user_id=0;var a=this.getForm().items.map.name;a.items.each(function(d,b,c){d.clearValue();d.clearInvalid()},this)}},autoSelectName:function(b){if(!this.noNames){b.user_id=this.data.ID;var a=b.getForm().items.map.name;a.items.each(function(e,c,d){e.setValue(this.data[e.getName()]);e.disable()},this)}},showPanel:function(a){var e=Ext.get("tmn-"+this.id+"-authorisation-div"),f;if(!this.noNames){f=this.nameStore.getRange();if(f.length==1){this.autoSelectName.call(f[0],this)}else{this.resetFields()}}this.show();this.reasonArray=a;if(e==null){var b=new Ext.XTemplate('<tpl for="id"><div id="tmn-{id}-authorisation-div" class="tmn-page"></div></tpl>');b.append(this.body,{id:[{id:this.id}]});e=Ext.get("tmn-"+this.id+"-authorisation-div")}if(a["aussie-based"]!==undefined){if(a["aussie-based"]["reasons"].length>0){var b=new Ext.XTemplate('<div class="tmn-authorisation">','<div class="header">Reasons for Needing '+this.leader+" Authorisation</div>",'<tpl for="reasons"><div class="reason">- {reason}</div></tpl>',"</div>");b.overwrite(e,a["aussie-based"])}}else{var c=null;if(a["international-assignment"]["reasons"].length>0){var b=new Ext.XTemplate('<div class="tmn-authorisation">','<div class="header">International Assignment - Reasons for Needing '+this.leader+" Authorisation</div>",'<tpl for="reasons"><div class="reason">- {reason}</div></tpl>',"</div>");c=b.overwrite(e,a["international-assignment"],true)}if(a["home-assignment"]["reasons"].length>0){var d;if(c==null){c=e;d=new Ext.XTemplate('<div class="tmn-authorisation">','<div class="header">Home Assignment - Reasons for Needing '+this.leader+" Authorisation</div>",'<tpl for="reasons"><div class="reason">- {reason}</div></tpl>',"</div>")}else{d=new Ext.XTemplate("<p>&nbsp;</p>",'<div class="tmn-authorisation">','<div class="header">Home Assignment - Reasons for Needing '+this.leader+" Authorisation</div>",'<tpl for="reasons"><div class="reason">- {reason}</div></tpl>',"</div>")}d.overwrite(c,a["home-assignment"])}}},showUnusedPanel:function(){var b=Ext.get("tmn-"+this.id+"-authorisation-div");if(b==null){var a=new Ext.XTemplate('<tpl for="id"><div id="tmn-{id}-authorisation-div" class="tmn-page"></div></tpl>');a.append(this.body,{id:[{id:this.id}]});b=Ext.get("tmn-"+this.id+"-authorisation-div")}var a=new Ext.XTemplate("<div>",'<tpl for="leaders"><div class="authorisation-note"> Your {leader} Authoriser does not need to authorise this TMN we just need to record who you report to at this point in time for future reference.</div></tpl>',"</div>");a.overwrite(b,{leaders:[{leader:this.leader}]})},resetPanel:function(){var a=Ext.get("tmn-"+this.id+"-authorisation-div");if(a!=null){a.remove()}if(this.reasonArray!==undefined){delete this.reasonArray}this.resetFields()},hidePanel:function(){this.resetFields();this.hide()}});Ext.ns("tmn","tmn.view");tmn.view.SummaryPanel=function(a,b){this.view=a||{};b=b||{};var c=b.id||"summary_panel";this.templates={};this.templates["aussie-based"]={};this.templates["international-assignment"]={};this.templates["home-assignment"]={};this.templates["aussie-based"]["single"]=new Ext.XTemplate('<!-- START aussie-based-single --><div class="tmn-page"><table><tr><td><h1 class="tmn-title">Total Monthly Needs</h1></td><td><img class="tmn-logo" src="http://www.ccca.org.au/tntmpd/TntMPDCCCALogo-new.JPG" alt="CCCA Logo" /></td></tr></table><div class="tmn-instructions"><div>The TMN is now submitted online, you may still want to save/print a copy for your own records.</div></div><p>&nbsp;</p><table><tr><td style="width:50%;"><b>Name: </b>{firstname} {surname}</td><td style="width:25%;"><b>Date: </b>{date}</td><td style="width:25%;"><b>Support Account: </b>{fan}</td></tr><tr><td colspan="3"><br /><br /></td></tr><tr><td colspan="3"><hr /></td></tr><tpl if="regular_buffer == 0"><tr class="tmn-goals"><th>Your Monthly Support Goal is: ${tmn}</th><th colspan="2">Your Account must be above: ${buffer}</th></tr></tpl><tpl if="regular_buffer &gt; 0"><tr class="tmn-goals"><th>Your Monthly Support Goal is: ${tmn}</th><th>Your Account must be above ${buffer} to start</th><th>Normally Your Account must be above: ${regular_buffer}</th></tr></tpl><tr><td colspan="3"><hr /></td></tr></table><p>&nbsp;</p><div class="tmn-break-down"><div class="header">TMN Break Down</div><table><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Name</th><td>{firstname}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Ministry</th><td>{ministry}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Status</th><td>{ft_pt_os} - {days_per_wk} Days</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Stipend (Money in your account)</th><td>${stipend}</td></tr><tpl if="housing_stipend &gt; 0"><tr class="tmn-data"><th colspan="2">Housing Stipend (The amount of your stipend that will be used on housing)</th><td>${housing_stipend}</td></tr></tpl><tpl if="taxable_future_investment &gt; 0"><tr class="tmn-data"><th colspan="2">Future Investment (The amount of your stipend that will go toward your nominated investment)</th><td>${taxable_future_investment}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Estimated Tax </th><td>${tax}</td></tr><tr class="tmn-data"><th colspan="2">Additional Tax </th><td>${additional_tax}</td></tr><tr class="tmn-data"><th colspan="2">Post-tax Super </th><td>${post_tax_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Taxable Income (Stipend + <tpl if="housing_stipend &gt; 0">Housing Stipend + </tpl><tpl if="taxable_future_investment &gt; 0">Future Investment + </tpl>Estimated Tax + Additional Tax + Post-Tax Super)</th><td>${taxable_income}</td></tr><tr><td colspan="3"><hr /></td></tr><tpl if="pre_tax_super &gt; 0"><tr class="tmn-data"><th colspan="2">Pre-tax Super </th><td>${pre_tax_super}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Additional Life Cover (per month)</th><td>${additional_life_cover}</td></tr><tr class="tmn-data"><th colspan="2">MFB\'s</th><td>${max_mfb}</td></tr><tpl if="additional_housing &gt; 0"><tr class="tmn-data"><th colspan="2">Additional Housing Allowance</th><td>${additional_housing_allowance}</td></tr></tpl><tpl if="additional_mortgage &gt; 0"><tr class="tmn-data"><th colspan="2">Additional Mortgage Payment</th><td>${additional_mortgage}</td></tr></tpl><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Financial Package </th><td>${financial_package}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Employer Super </th><td>${employer_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">MMR</th><td>${mmr}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Total Internal Transfers</th><td>${total_transfers}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Worker\'s Compensation</th><td>${workers_comp}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">CCCA Levy</th><td>${ccca_levy}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Needs</th><td>${tmn}</td></tr><tr><td colspan="3"><hr /></td></tr></table></div><tpl if="housing &gt; 0"><p>&nbsp;</p><div class="tmn-housing-summary"><div class="header">Housing Summary</div><table><tr class="tmn-data"><th colspan="2">The amount that comes from your MFBs monthly</th><td>${housing_mfb}</td></tr><tpl if="housing_stipend &gt; 0"><tr class="tmn-data"><th colspan="2">The amount that comes from you Stipend monthly</th><td>${housing_stipend}</td></tr></tpl><tpl if="additional_mortgage &gt; 0"><tr class="tmn-data"><th colspan="2">The amount that comes from your Future Investment (Additional Mortgage Payment) monthly</th><td>${additional_mortgage}</td></tr></tpl><tr class="tmn-data"><th colspan="2">The amount that comes from Additional Housing Allowance monthly</th><td>${additional_housing}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Housing</th><td>${monthly_housing}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th style="text-align:center;" colspan="4">CCCA will pay ${housing} into your elected housing account {housing_frequency}.</th></tr><tr><td colspan="3"><hr /></td></tr><tpl if="additional_mortgage &gt; 0"><tr><th style="text-align:center;" colspan="4">CCCA will also pay an additional ${additional_mortgage} monthly toward your mortgage.<br />This payment will be paid according to the details on your Future Investment Form.</th></tr><tr><td colspan="3"><hr /></td></tr></tpl></table></div></tpl><tpl if="max_mfb &gt; 0"><p>&nbsp;</p><div class="tmn-mfb-summary"><div class="header">Ministry Fringe Benifits Summary</div><table><tr><th colspan="2">MFB Rate</th><td>{mfb_rate}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">The amount of your MFBs that you can make claims from</th><td>${claimable_mfb}</td></tr><tr class="tmn-data"><th colspan="2">The amount of your MFBs that will go toward housing</th><td>${housing_mfb}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Ministry Fringe Benifits</th><td>${max_mfb}</td></tr><tr><td colspan="3"><hr /></td></tr></table></div></tpl><p>&nbsp;</p><div class="tmn-super-summary"><div class="header">Super Summary</div><table><tr class="tmn-data"><th colspan="2">Post Tax Super</th><td>${post_tax_super}</td></tr><tpl if="pre_tax_super &gt; 0"><tr class="tmn-data"><th colspan="2">Pre Tax Super</th><td>${pre_tax_super}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Employer Super</th><td>${employer_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Super</th><td>${total_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Reportable Employer Super Contribution (RESC)</th><td>${resc}</td></tr><tr><th colspan="2">Super Choice</th><td>{super_fund}</td></tr><tpl if="additional_life_cover &gt; 0"><tr><th colspan="2">Amount of Additional Life Cover</th><td>${additional_life_cover}</td></tr></tpl><tr><th colspan="2">Additional Income Protection Premium paid from</th><td>{income_protection_cover_source}</td></tr></table></div><tpl if="total_transfers &gt; 0"><p>&nbsp;</p><div class="tmn-internal-transfer-summary"><div class="header">Internal Transfer Summary</div><table><tr><th colspan="2">Internal Transfers: </th><td>Name</td><td>Amount</td></tr><tpl for="transfers"><tr class="tmn-data"><th colspan="2"></th><td>{name}</td><td>${amount}</td></tr></tpl><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Internal Transfers</th><td colspan="2">${total_transfers}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div></tpl><p>&nbsp;</p><p class="footer">Version: {versionnumber}</p></div><!-- END aussie-based-single -->');this.templates["aussie-based"]["spouse"]=new Ext.XTemplate('<!-- START aussie-based-couple --><div class="tmn-page"><table><tr><td><h1 class="tmn-title">Total Monthly Needs</h1></td><td><img class="tmn-logo" src="http://www.ccca.org.au/tntmpd/TntMPDCCCALogo-new.JPG" alt="CCCA Logo" /></td></tr></table><div class="tmn-instructions"><div>The TMN is now submitted online, you may still want to save/print a copy for your own records.</div></div><p>&nbsp;</p><table><tr><td style="width:50%;"><b>Name: </b>{firstname} {surname} &amp; {s_firstname} {s_surname}</td><td style="width:25%;"><b>Date: </b>{date}</td><td style="width:25%;"><b>Support Account: </b>{fan}</td></tr><tr><td colspan="3"><br /><br /></td></tr><tr><td colspan="3"><hr /></td></tr><tpl if="regular_buffer == 0"><tr class="tmn-goals"><th>Your Monthly Support Goal is: ${tmn}</th><th colspan="2">Your Account must be above: ${buffer}</th></tr></tpl><tpl if="regular_buffer &gt; 0"><tr class="tmn-goals"><th>Your Monthly Support Goal is: ${tmn}</th><th>Your Account must be above ${buffer} to start</th><th>Normally Your Account must be above: ${regular_buffer}</th></tr></tpl><tr><td colspan="3"><hr /></td></tr></table><p>&nbsp;</p><div class="tmn-break-down"><div class="header">TMN Break Down</div><table><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Name</th><td>{firstname}</td><td>{s_firstname}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Ministry</th><td>{ministry}</td><td>{s_ministry}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Status</th><td>{ft_pt_os} - {days_per_wk} Days</td><td>{s_ft_pt_os} - {s_days_per_wk} Days</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Stipend (Money in your account)</th><td>${stipend}</td><td>${s_stipend}</td></tr><tpl if="housing_stipend &gt; 0 || s_housing_stipend &gt; 0"><tr class="tmn-data"><th colspan="2">Housing Stipend (The amount of your stipend that will be used on housing)</th><td>${housing_stipend}</td><td>${s_housing_stipend}</td></tr></tpl><tpl if="taxable_future_investment &gt; 0 || s_taxable_future_investment &gt; 0"><tr class="tmn-data"><th colspan="2">Future Investment (The amount of your stipend that will go toward your nominated investment)</th><td>${taxable_future_investment}</td><td>${s_taxable_future_investment}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Estimated Tax </th><td>${tax}</td><td>${s_tax}</td></tr><tr class="tmn-data"><th colspan="2">Additional Tax </th><td>${additional_tax}</td><td>${s_additional_tax}</td></tr><tr class="tmn-data"><th colspan="2">Post-tax Super </th><td>${post_tax_super}</td><td>${s_post_tax_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Taxable Income (Stipend + <tpl if="housing_stipend &gt; 0 || s_housing_stipend &gt; 0">Housing Stipend + </tpl><tpl if="taxable_future_investment &gt; 0 || s_taxable_future_investment &gt; 0">Future Investment + </tpl>Estimated Tax + Additional Tax + Post-Tax Super)</th><td>${taxable_income}</td><td>${s_taxable_income}</td></tr><tr><td colspan="4"><hr /></td></tr><tpl if="pre_tax_super &gt; 0 || s_pre_tax_super &gt; 0"><tr class="tmn-data"><th colspan="2">Pre-tax Super </th><td>${pre_tax_super}</td><td>${s_pre_tax_super}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Additional Life Cover (per month)</th><td>${additional_life_cover}</td><td>${s_additional_life_cover}</td></tr><tr class="tmn-data"><th colspan="2">MFB\'s</th><td>${max_mfb}</td><td>${s_max_mfb}</td></tr><tpl if="additional_housing &gt; 0"><tr class="tmn-data"><th colspan="2">Additional Housing Allowance</th><td>${additional_housing_allowance}</td><td>${s_additional_housing_allowance}</td></tr></tpl><tpl if="additional_mortgage &gt; 0"><tr class="tmn-data"><th colspan="2">Additional Mortgage Payment</th><td colspan="2">${additional_mortgage}</td></tr></tpl><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Financial Package </th><td>${financial_package}</td><td>${s_financial_package}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Joint Financial Package</th><td colspan="2">${joint_financial_package}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Employer Super </th><td>${employer_super}</td><td>${s_employer_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">MMR</th><td>${mmr}</td><td>${s_mmr}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Total Internal Transfers</th><td colspan="2">${total_transfers}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Worker\'s Compensation</th><td colspan="2">${workers_comp}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">CCCA Levy</th><td colspan="2">${ccca_levy}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Needs</th><td colspan="2">${tmn}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div><tpl if="housing &gt; 0"><p>&nbsp;</p><div class="tmn-housing-summary"><div class="header">Housing Summary</div><table><tr class="tmn-data"><th colspan="2">The amount that comes from your MFBs monthly</th><td>${housing_mfb}</td><td>${s_housing_mfb}</td></tr><tpl if="housing_stipend &gt; 0 || s_housing_stipend &gt; 0"><tr class="tmn-data"><th colspan="2">The amount that comes from you Stipend monthly</th><td>${housing_stipend}</td><td>${s_housing_stipend}</td></tr></tpl><tpl if="additional_mortgage &gt; 0"><tr class="tmn-data"><th colspan="2">The amount that comes from your Future Investment (Additional Mortgage Payment) monthly</th><td colspan="2">${additional_mortgage}</td></tr></tpl><tr class="tmn-data"><th colspan="2">The amount that comes from Additional Housing Allowance monthly</th><td colspan="2">${additional_housing}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Housing</th><td colspan="2">${monthly_housing}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th style="text-align:center;" colspan="4">CCCA will pay ${housing} into your elected housing account {housing_frequency}.</th></tr><tr><td colspan="4"><hr /></td></tr><tpl if="additional_mortgage &gt; 0"><tr><th style="text-align:center;" colspan="4">CCCA will also pay an additional ${additional_mortgage} monthly toward your mortgage.<br />This payment will be paid according to the details on your Future Investment Form.</th></tr><tr><td colspan="4"><hr /></td></tr></tpl></table></div></tpl><tpl if="max_mfb &gt; 0 || s_max_mfb &gt; 0"><p>&nbsp;</p><div class="tmn-mfb-summary"><div class="header">Ministry Fringe Benifits Summary</div><table><tr><th colspan="2">MFB Rate</th><td>{mfb_rate}</td><td>{s_mfb_rate}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">The amount of your MFBs that you can make claims from</th><td>${claimable_mfb}</td><td>${s_claimable_mfb}</td></tr><tr class="tmn-data"><th colspan="2">The amount of your MFBs that will go toward housing</th><td>${housing_mfb}</td><td>${s_housing_mfb}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Ministry Fringe Benifits</th><td>${max_mfb}</td><td>${s_max_mfb}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div></tpl><p>&nbsp;</p><div class="tmn-super-summary"><div class="header">Super Summary</div><table><tr class="tmn-data"><th colspan="2">Post Tax Super</th><td>${post_tax_super}</td><td>${s_post_tax_super}</td></tr><tpl if="pre_tax_super &gt; 0 || s_pre_tax_super &gt; 0"><tr class="tmn-data"><th colspan="2">Pre Tax Super</th><td>${pre_tax_super}</td><td>${s_pre_tax_super}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Employer Super</th><td>${employer_super}</td><td>${s_employer_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Super</th><td>${total_super}</td><td>${s_total_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Reportable Employer Super Contribution (RESC)</th><td>${resc}</td><td>${s_resc}</td></tr><tr><th colspan="2">Super Choice</th><td>{super_fund}</td><td>{s_super_fund}</td></tr><tpl if="additional_life_cover &gt; 0 || s_additional_life_cover &gt; 0"><tr><th colspan="2">Amount of Additional Life Cover</th><td>${additional_life_cover}</td><td>${s_additional_life_cover}</td></tr></tpl><tr><th colspan="2">Additional Income Protection Premium paid from</th><td>{income_protection_cover_source}</td><td>{s_income_protection_cover_source}</td></tr></table></div><tpl if="total_transfers &gt; 0"><p>&nbsp;</p><div class="tmn-internal-transfer-summary"><div class="header">Internal Transfer Summary</div><table><tr><th colspan="2">Internal Transfers: </th><td>Name</td><td>Amount</td></tr><tpl for="transfers"><tr class="tmn-data"><th colspan="2"></th><td>{name}</td><td>${amount}</td></tr></tpl><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Internal Transfers</th><td colspan="2">${total_transfers}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div></tpl><p>&nbsp;</p><p class="footer">Version: {versionnumber}</p></div><!-- END aussie-based-couple -->');this.templates["international-assignment"]["single"]=new Ext.XTemplate('<!-- START international-assignment-single --><div class="tmn-page"><table><tr><td><h1 class="tmn-title">Total Monthly Needs</h1></td></tr></table><div class="tmn-instructions"><div>The TMN is now submitted online, you may still want to save/print a copy for your own records.</div></div><p>&nbsp;</p><table><tr><td style="width:50%;"><b>Name: </b>{firstname} {surname}</td><td style="width:25%;"><b>Date: </b>{date}</td><td style="width:25%;"><b>Support Account: </b>{fan}</td></tr><tr><td colspan="3"><br /><br /></td></tr><tr><td colspan="3"><hr /></td></tr><tpl if="regular_buffer == 0"><tr class="tmn-goals"><th>Your Monthly Support Goal is: ${tmn}</th><th colspan="2">Your Account must be above: ${buffer}</th></tr></tpl><tpl if="regular_buffer &gt; 0"><tr class="tmn-goals"><th>Your Monthly Support Goal is: ${tmn}</th><th>Your Account must be above ${buffer} to start</th><th>Normally Your Account must be above: ${regular_buffer}</th></tr></tpl><tr><td colspan="3"><hr /></td></tr></table><p>&nbsp;</p><div class="tmn-international-break-down"><div class="header">TMN Break Down for International Assignment</div><table><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Name</th><td>{firstname}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Ministry</th><td>{ministry}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Dates of Assignment</th><td>{os_assignment_start_date} - {os_assignment_end_date}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Status</th><td>{ft_pt_os} - {days_per_wk} Days</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Tax Status</th><td>{os_resident_for_tax_purposes}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Net Stipend</th><td>${net_stipend}</td></tr><tr class="tmn-data"><th colspan="2">Estimated Tax </th><td>${tax}</td></tr><tr class="tmn-data"><th colspan="2">Additional Tax </th><td>${additional_tax}</td></tr><tr class="tmn-data"><th colspan="2">Post-tax Super </th><td>${post_tax_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Taxable Income (Net Stipend + Estimated Tax + Additional Tax + Post-Tax Super)</th><td>${taxable_income}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Pre-tax Super </th><td>${pre_tax_super}</td></tr><tr class="tmn-data"><th colspan="2">Additional Life Cover (per month)</th><td>${additional_life_cover}</td></tr><tr class="tmn-data"><th colspan="2">LAFHA</th><td>${os_lafha}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Financial Package </th><td>${financial_package}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Employer Super </th><td>${employer_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">MMR</th><td>${mmr}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Total Internal Transfers</th><td>${total_transfers}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Worker\'s Compensation</th><td>${workers_comp}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">CCCA Levy</th><td>${ccca_levy}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Needs</th><td>${tmn}</td></tr><tr><td colspan="3"><hr /></td></tr></table></div><p>&nbsp;</p><div class="tmn-super-summary"><div class="header">Super Summary</div><table><tr class="tmn-data"><th colspan="2">Post Tax Super</th><td>${post_tax_super}</td></tr><tr class="tmn-data"><th colspan="2">Pre Tax Super</th><td>${pre_tax_super}</td></tr><tr class="tmn-data"><th colspan="2">Employer Super</th><td>${employer_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Super</th><td>${total_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Reportable Employer Super Contribution (RESC)</th><td>${resc}</td></tr><tr><th colspan="2">Super Choice</th><td>{super_fund}</td></tr><tpl if="additional_life_cover &gt; 0"><tr><th colspan="2">Amount of Additional Life Cover</th><td>${additional_life_cover}</td></tr></tpl><tr><th colspan="2">Additional Income Protection Premium paid from</th><td>{income_protection_cover_source}</td></tr></table></div><tpl if="total_transfers &gt; 0"><p>&nbsp;</p><div class="tmn-internal-transfer-summary"><div class="header">Internal Transfer Summary</div><table><tr><th colspan="2">Internal Transfers: </th><td>Name</td><td>Amount</td></tr><tpl for="transfers"><tr class="tmn-data"><th colspan="2"></th><td>{name}</td><td>${amount}</td></tr></tpl><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Internal Transfers</th><td colspan="2">${total_transfers}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div></tpl><p>&nbsp;</p></div><!-- END international-assignment-single -->');this.templates["international-assignment"]["spouse"]=new Ext.XTemplate('<!-- START international-assignment-couple --><div class="tmn-page"><table><tr><td><h1 class="tmn-title">Total Monthly Needs</h1></td></tr></table><div class="tmn-instructions"><div>The TMN is now submitted online, you may still want to save/print a copy for your own records.</div></div><p>&nbsp;</p><table><tr><td style="width:50%;"><b>Name: </b>{firstname} {surname} &amp; {s_firstname} {s_surname}</td><td style="width:25%;"><b>Date: </b>{date}</td><td style="width:25%;"><b>Support Account: </b>{fan}</td></tr><tr><td colspan="3"><br /><br /></td></tr><tr><td colspan="3"><hr /></td></tr><tpl if="regular_buffer == 0"><tr class="tmn-goals"><th>Your Monthly Support Goal is: ${tmn}</th><th colspan="2">Your Account must be above: ${buffer}</th></tr></tpl><tpl if="regular_buffer &gt; 0"><tr class="tmn-goals"><th>Your Monthly Support Goal is: ${tmn}</th><th>Your Account must be above ${buffer} to start</th><th>Normally Your Account must be above: ${regular_buffer}</th></tr></tpl><tr><td colspan="3"><hr /></td></tr></table><p>&nbsp;</p><div class="tmn-international-break-down"><div class="header">TMN Break Down for International Assignment</div><table><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Name</th><td>{firstname}</td><td>{s_firstname}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Ministry</th><td>{ministry}</td><td>{s_ministry}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Dates of Assignment</th><td colspan="2">{os_assignment_start_date} - {os_assignment_end_date}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Status</th><td>{ft_pt_os} - {days_per_wk} Days</td><td>{s_ft_pt_os} - {s_days_per_wk} Days</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Tax Status</th><td colspan="2">{os_resident_for_tax_purposes}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Net Stipend</th><td>${net_stipend}</td><td>${s_net_stipend}</td></tr><tr class="tmn-data"><th colspan="2">Estimated Tax </th><td>${tax}</td><td>${s_tax}</td></tr><tr class="tmn-data"><th colspan="2">Additional Tax </th><td>${additional_tax}</td><td>${s_additional_tax}</td></tr><tr class="tmn-data"><th colspan="2">Post-tax Super </th><td>${post_tax_super}</td><td>${s_post_tax_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Taxable Income (Net Stipend + Estimated Tax + Additional Tax + Post-Tax Super)</th><td>${taxable_income}</td><td>${s_taxable_income}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Pre-tax Super </th><td>${pre_tax_super}</td><td>${s_pre_tax_super}</td></tr><tr class="tmn-data"><th colspan="2">Additional Life Cover (per month)</th><td>${additional_life_cover}</td><td>${s_additional_life_cover}</td></tr><tr class="tmn-data"><th colspan="2">LAFHA</th><td>${os_lafha}</td><td>${s_os_lafha}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Financial Package </th><td>${financial_package}</td><td>${s_financial_package}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Joint Financial Package</th><td colspan="2">${joint_financial_package}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Employer Super </th><td>${employer_super}</td><td>${s_employer_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">MMR</th><td>${mmr}</td><td>${s_mmr}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Total Internal Transfers</th><td colspan="2">${total_transfers}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Worker\'s Compensation</th><td colspan="2">${workers_comp}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">CCCA Levy</th><td colspan="2">${ccca_levy}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Needs</th><td colspan="2">${tmn}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div><p>&nbsp;</p><div class="tmn-super-summary"><div class="header">Super Summary</div><table><tr class="tmn-data"><th colspan="2">Post Tax Super</th><td>${post_tax_super}</td><td>${s_post_tax_super}</td></tr><tr class="tmn-data"><th colspan="2">Pre Tax Super</th><td>${pre_tax_super}</td><td>${s_pre_tax_super}</td></tr><tr class="tmn-data"><th colspan="2">Employer Super</th><td>${employer_super}</td><td>${s_employer_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Super</th><td>${total_super}</td><td>${s_total_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Reportable Employer Super Contribution (RESC)</th><td>${resc}</td><td>${s_resc}</td></tr><tr><th colspan="2">Super Choice</th><td>{super_fund}</td><td>{s_super_fund}</td></tr><tpl if="additional_life_cover &gt; 0 || s_additional_life_cover &gt; 0"><tr><th colspan="2">Amount of Additional Life Cover</th><td>${additional_life_cover}</td><td>${s_additional_life_cover}</td></tr></tpl><tr><th colspan="2">Additional Income Protection Premium paid from</th><td>{income_protection_cover_source}</td><td>{s_income_protection_cover_source}</td></tr></table></div><tpl if="total_transfers &gt; 0"><p>&nbsp;</p><div class="tmn-internal-transfer-summary"><div class="header">Internal Transfer Summary</div><table><tr><th colspan="2">Internal Transfers: </th><td>Name</td><td>Amount</td></tr><tpl for="transfers"><tr class="tmn-data"><th colspan="2"></th><td>{name}</td><td>${amount}</td></tr></tpl><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Internal Transfers</th><td colspan="2">${total_transfers}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div></tpl><p>&nbsp;</p></div><!-- END international-assignment-couple -->');this.templates["home-assignment"]["single"]=new Ext.XTemplate('<!-- START home-assignment-single --><div class="tmn-page"><div class="tmn-home-break-down"><div class="header">TMN Break Down for Home Assignment</div><table><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Name</th><td>{firstname}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Ministry</th><td>{ministry}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Dates of Assignment</th><td>{os_assignment_start_date} - {os_assignment_end_date}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Status</th><td>{ft_pt_os} - {days_per_wk} Days</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Tax Status</th><td>{os_resident_for_tax_purposes}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Stipend (Money in your account)</th><td>${stipend}</td></tr><tpl if="housing_stipend &gt; 0"><tr class="tmn-data"><th colspan="2">Housing Stipend (The amount of your stipend that will be used on housing)</th><td>${housing_stipend}</td></tr></tpl><tpl if="taxable_future_investment &gt; 0"><tr class="tmn-data"><th colspan="2">Future Investment (The amount of your stipend that will go toward your nominated investment)</th><td>${taxable_future_investment}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Estimated Tax </th><td>${tax}</td></tr><tr class="tmn-data"><th colspan="2">Additional Tax </th><td>${additional_tax}</td></tr><tr class="tmn-data"><th colspan="2">Post-tax Super </th><td>${post_tax_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Taxable Income (Stipend + <tpl if="housing_stipend &gt; 0">Housing Stipend + </tpl><tpl if="taxable_future_investment &gt; 0">Future Investment + </tpl>Estimated Tax + Additional Tax + Post-Tax Super)</th><td>${taxable_income}</td></tr><tr><td colspan="3"><hr /></td></tr><tpl if="pre_tax_super &gt; 0"><tr class="tmn-data"><th colspan="2">Pre-tax Super </th><td>${pre_tax_super}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Additional Life Cover (per month)</th><td>${additional_life_cover}</td></tr><tr class="tmn-data"><th colspan="2">MFB\'s</th><td>${max_mfb}</td></tr><tpl if="additional_housing &gt; 0"><tr class="tmn-data"><th colspan="2">Additional Housing Allowance</th><td>${additional_housing_allowance}</td></tr></tpl><tpl if="os_overseas_housing &gt; 0"><tr class="tmn-data"><th colspan="2">Overseas Housing Allowance</th><td>${os_overseas_housing_allowance}</td></tr></tpl><tpl if="additional_mortgage &gt; 0"><tr class="tmn-data"><th colspan="2">Additional Mortgage Payment</th><td>${additional_mortgage}</td></tr></tpl><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Financial Package </th><td>${financial_package}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Employer Super </th><td>${employer_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">MMR</th><td>${mmr}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Total Internal Transfers</th><td>${total_transfers}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Worker\'s Compensation</th><td>${workers_comp}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">CCCA Levy</th><td>${ccca_levy}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Needs</th><td>${tmn}</td></tr><tr><td colspan="3"><hr /></td></tr></table></div><tpl if="housing &gt; 0"><p>&nbsp;</p><div class="tmn-housing-summary"><div class="header">Housing Summary</div><table><tr class="tmn-data"><th colspan="2">The amount that comes from your MFBs monthly</th><td>${housing_mfb}</td></tr><tpl if="housing_stipend &gt; 0"><tr class="tmn-data"><th colspan="2">The amount that comes from you Stipend monthly</th><td>${housing_stipend}</td></tr></tpl><tpl if="additional_mortgage &gt; 0"><tr class="tmn-data"><th colspan="2">The amount that comes from your Future Investment (Additional Mortgage Payment) monthly</th><td>${additional_mortgage}</td></tr></tpl><tr class="tmn-data"><th colspan="2">The amount that comes from Additional Housing Allowance monthly</th><td>${additional_housing}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Housing</th><td>${monthly_housing}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th style="text-align:center;" colspan="3">CCCA will pay ${housing} into your elected housing account {housing_frequency}.</th></tr><tr><td colspan="3"><hr /></td></tr><tpl if="additional_mortgage &gt; 0"><tr><th style="text-align:center;" colspan="4">CCCA will also pay an additional ${additional_mortgage} monthly toward your mortgage.<br />This payment will be paid according to the details on your Future Investment Form.</th></tr><tr><td colspan="3"><hr /></td></tr></tpl><tr><th style="text-align:center;" colspan="3">CCCA will also give you ${os_overseas_housing} toward the cost of your housing outside of Australia.</th></tr><tr><td colspan="3"><hr /></td></tr></table></div></tpl><tpl if="max_mfb &gt; 0"><p>&nbsp;</p><div class="tmn-mfb-summary"><div class="header">Ministry Fringe Benifits Summary</div><table><tr><th colspan="2">MFB Rate</th><td>{mfb_rate}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-data"><th colspan="2">The amount of your MFBs that you can make claims from</th><td>${claimable_mfb}</td></tr><tr class="tmn-data"><th colspan="2">The amount of your MFBs that will go toward housing</th><td>${housing_mfb}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Ministry Fringe Benifits</th><td>${max_mfb}</td></tr><tr><td colspan="3"><hr /></td></tr></table></div></tpl><p>&nbsp;</p><div class="tmn-super-summary"><div class="header">Super Summary</div><table><tr class="tmn-data"><th colspan="2">Post Tax Super</th><td>${post_tax_super}</td></tr><tpl if="pre_tax_super &gt; 0"><tr class="tmn-data"><th colspan="2">Pre Tax Super</th><td>${pre_tax_super}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Employer Super</th><td>${employer_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Super</th><td>${total_super}</td></tr><tr><td colspan="3"><hr /></td></tr><tr><th colspan="2">Reportable Employer Super Contribution (RESC)</th><td>${resc}</td></tr><tr><th colspan="2">Super Choice</th><td>{super_fund}</td></tr><tpl if="additional_life_cover &gt; 0"><tr><th colspan="2">Amount of Additional Life Cover</th><td>${additional_life_cover}</td></tr></tpl><tr><th colspan="2">Additional Income Protection Premium paid from</th><td>{income_protection_cover_source}</td></tr></table></div><tpl if="total_transfers &gt; 0"><p>&nbsp;</p><div class="tmn-internal-transfer-summary"><div class="header">Internal Transfer Summary</div><table><tr><th colspan="2">Internal Transfers: </th><td>Name</td><td>Amount</td></tr><tpl for="transfers"><tr class="tmn-data"><th colspan="2"></th><td>{name}</td><td>${amount}</td></tr></tpl><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Internal Transfers</th><td colspan="2">${total_transfers}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div></tpl><p>&nbsp;</p><p class="footer">Version: {versionnumber}</p></div><!-- END home-assignment-single -->');this.templates["home-assignment"]["spouse"]=new Ext.XTemplate('<!-- START home-assignment-couple --><div class="tmn-page"><div class="tmn-home-break-down"><div class="header">TMN Break Down for Home Assignment</div><table><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Name</th><td>{firstname}</td><td>{s_firstname}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Ministry</th><td>{ministry}</td><td>{s_ministry}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Dates of Assignment</th><td colspan="2">{os_assignment_start_date} - {os_assignment_end_date}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Status</th><td>{ft_pt_os} - {days_per_wk} Days</td><td>{s_ft_pt_os} - {s_days_per_wk} Days</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Tax Status</th><td colspan="2">{os_resident_for_tax_purposes}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Stipend (Money in your account)</th><td>${stipend}</td><td>${s_stipend}</td></tr><tpl if="housing_stipend &gt; 0 || s_housing_stipend &gt; 0"><tr class="tmn-data"><th colspan="2">Housing Stipend (The amount of your stipend that will be used on housing)</th><td>${housing_stipend}</td><td>${s_housing_stipend}</td></tr></tpl><tpl if="taxable_future_investment &gt; 0 || s_taxable_future_investment &gt; 0"><tr class="tmn-data"><th colspan="2">Future Investment (The amount of your stipend that will go toward your nominated investment)</th><td>${taxable_future_investment}</td><td>${s_taxable_future_investment}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Estimated Tax </th><td>${tax}</td><td>${s_tax}</td></tr><tr class="tmn-data"><th colspan="2">Additional Tax </th><td>${additional_tax}</td><td>${s_additional_tax}</td></tr><tr class="tmn-data"><th colspan="2">Post-tax Super </th><td>${post_tax_super}</td><td>${s_post_tax_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Taxable Income (Stipend + <tpl if="housing_stipend &gt; 0 || s_housing_stipend &gt; 0">Housing Stipend + </tpl><tpl if="taxable_future_investment &gt; 0 || s_taxable_future_investment &gt; 0">Future Investment + </tpl>Estimated Tax + Additional Tax + Post-Tax Super)</th><td>${taxable_income}</td><td>${s_taxable_income}</td></tr><tr><td colspan="4"><hr /></td></tr><tpl if="pre_tax_super &gt; 0 || s_pre_tax_super &gt; 0"><tr class="tmn-data"><th colspan="2">Pre-tax Super </th><td>${pre_tax_super}</td><td>${s_pre_tax_super}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Additional Life Cover (per month)</th><td>${additional_life_cover}</td><td>${s_additional_life_cover}</td></tr><tr class="tmn-data"><th colspan="2">MFB\'s</th><td>${max_mfb}</td><td>${s_max_mfb}</td></tr><tpl if="additional_housing &gt; 0"><tr class="tmn-data"><th colspan="2">Additional Housing Allowance</th><td>${additional_housing_allowance}</td><td>${s_additional_housing_allowance}</td></tr></tpl><tpl if="os_overseas_housing &gt; 0"><tr class="tmn-data"><th colspan="2">Overseas Housing Allowance</th><td>${os_overseas_housing_allowance}</td><td>${s_os_overseas_housing_allowance}</td></tr></tpl><tpl if="additional_mortgage &gt; 0"><tr class="tmn-data"><th colspan="2">Additional Mortgage Payment</th><td colspan="2">${additional_mortgage}</td></tr></tpl><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Financial Package </th><td>${financial_package}</td><td>${s_financial_package}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Joint Financial Package</th><td colspan="2">${joint_financial_package}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Employer Super </th><td>${employer_super}</td><td>${s_employer_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">MMR</th><td>${mmr}</td><td>${s_mmr}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Total Internal Transfers</th><td colspan="2">${total_transfers}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">Worker\'s Compensation</th><td colspan="2">${workers_comp}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">CCCA Levy</th><td colspan="2">${ccca_levy}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Needs</th><td colspan="2">${tmn}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div><tpl if="housing &gt; 0"><p>&nbsp;</p><div class="tmn-housing-summary"><div class="header">Housing Summary</div><table><tr class="tmn-data"><th colspan="2">The amount that comes from your MFBs monthly</th><td>${housing_mfb}</td><td>${s_housing_mfb}</td></tr><tpl if="housing_stipend &gt; 0 || s_housing_stipend &gt; 0"><tr class="tmn-data"><th colspan="2">The amount that comes from you Stipend monthly</th><td>${housing_stipend}</td><td>${s_housing_stipend}</td></tr></tpl><tpl if="additional_mortgage &gt; 0"><tr class="tmn-data"><th colspan="2">The amount that comes from your Future Investment (Additional Mortgage Payment) monthly</th><td colspan="2">${additional_mortgage}</td></tr></tpl><tr class="tmn-data"><th colspan="2">The amount that comes from Additional Housing Allowance monthly</th><td colspan="2">${additional_housing}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Monthly Housing</th><td colspan="2">${monthly_housing}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th style="text-align:center;" colspan="4">CCCA will pay ${housing} into your elected housing account {housing_frequency}.</th></tr><tr><td colspan="4"><hr /></td></tr><tpl if="additional_mortgage &gt; 0"><tr><th style="text-align:center;" colspan="4">CCCA will also pay an additional ${additional_mortgage} monthly toward your mortgage.<br />This payment will be paid according to the details on your Future Investment Form.</th></tr><tr><td colspan="4"><hr /></td></tr></tpl><tr><th style="text-align:center;" colspan="4">CCCA will also give you ${os_overseas_housing} toward the cost of your housing outside of Australia.</th></tr><tr><td colspan="4"><hr /></td></tr></table></div></tpl><tpl if="max_mfb &gt; 0 || s_max_mfb &gt; 0"><p>&nbsp;</p><div class="tmn-mfb-summary"><div class="header">Ministry Fringe Benifits Summary</div><table><tr><th colspan="2">MFB Rate</th><td>{mfb_rate}</td><td>{s_mfb_rate}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-data"><th colspan="2">The amount of your MFBs that you can make claims from</th><td>${claimable_mfb}</td><td>${s_claimable_mfb}</td></tr><tr class="tmn-data"><th colspan="2">The amount of your MFBs that will go toward housing</th><td>${housing_mfb}</td><td>${s_housing_mfb}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Ministry Fringe Benifits</th><td>${max_mfb}</td><td>${s_max_mfb}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div></tpl><p>&nbsp;</p><div class="tmn-super-summary"><div class="header">Super Summary</div><table><tr class="tmn-data"><th colspan="2">Post Tax Super</th><td>${post_tax_super}</td><td>${s_post_tax_super}</td></tr><tpl if="pre_tax_super &gt; 0 || s_pre_tax_super &gt; 0"><tr class="tmn-data"><th colspan="2">Pre Tax Super</th><td>${pre_tax_super}</td><td>${s_pre_tax_super}</td></tr></tpl><tr class="tmn-data"><th colspan="2">Employer Super</th><td>${employer_super}</td><td>${s_employer_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Super</th><td>${total_super}</td><td>${s_total_super}</td></tr><tr><td colspan="4"><hr /></td></tr><tr><th colspan="2">Reportable Employer Super Contribution (RESC)</th><td>${resc}</td><td>${s_resc}</td></tr><tr><th colspan="2">Super Choice</th><td>{super_fund}</td><td>{s_super_fund}</td></tr><tpl if="additional_life_cover &gt; 0 || s_additional_life_cover &gt; 0"><tr><th colspan="2">Amount of Additional Life Cover</th><td>${additional_life_cover}</td><td>${s_additional_life_cover}</td></tr></tpl><tr><th colspan="2">Additional Income Protection Premium paid from</th><td>{income_protection_cover_source}</td><td>{s_income_protection_cover_source}</td></tr></table></div><tpl if="total_transfers &gt; 0"><p>&nbsp;</p><div class="tmn-internal-transfer-summary"><div class="header">Internal Transfer Summary</div><table><tr><th colspan="2">Internal Transfers: </th><td>Name</td><td>Amount</td></tr><tpl for="transfers"><tr class="tmn-data"><th colspan="2"></th><td>{name}</td><td>${amount}</td></tr></tpl><tr><td colspan="4"><hr /></td></tr><tr class="tmn-total"><th colspan="2">Total Internal Transfers</th><td colspan="2">${total_transfers}</td></tr><tr><td colspan="4"><hr /></td></tr></table></div></tpl><p>&nbsp;</p><p class="footer">Version: {versionnumber}</p></div><!-- END home-assignment-couple -->');var b={itemId:c,frame:true,header:false,bodyStyle:"padding:0"};tmn.view.SummaryPanel.superclass.constructor.call(this,b)};Ext.extend(tmn.view.SummaryPanel,Ext.Panel,{renderSummary:function(c,b,a){if(c["aussie-based"]!==undefined||(c["international-assignment"]!==undefined&&c["home-assignment"]!==undefined)){if(b){if(a){this.templates["international-assignment"]["spouse"].overwrite(this.body,c["international-assignment"]);this.templates["home-assignment"]["spouse"].append(this.body,c["home-assignment"])}else{this.templates["international-assignment"]["single"].overwrite(this.body,c["international-assignment"]);this.templates["home-assignment"]["single"].append(this.body,c["home-assignment"])}}else{if(a){this.templates["aussie-based"]["spouse"].overwrite(this.body,c["aussie-based"])}else{this.templates["aussie-based"]["single"].overwrite(this.body,c["aussie-based"])}}}else{Ext.MessageBox.show({icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,closable:false,title:"Error",msg:'Your values can not be displayed. Try again by pressing the Previous button in the bottom left corner of the document followed by pressing the Next button in the bottom right. If you see this error again contact <a href="mailto:tech.team@ccca.org.au">tech.team@ccca.org.au</a>.'})}},resetSummary:function(){if(this.rendered){this.body.update("")}},printSummary:function(){Ext.ux.Printer.print(this)}});Ext.ns("tmn","tmn.view");tmn.view.PrintForm=function(a,b){this.view=a||{};b=b||{};this.id=b.id||"print_form";this.title=b.title||"Total Monthly Needs";this.load_url=b.load_url||"";this.submit_url=b.submit_url||"php/submit_tmn_for_authorisation.php";this.aussie_form;this.overseas_form;(b.aussie_form===undefined)?this.aussie_form=true:this.aussie_form=b.aussie_form;(b.overseas_form===undefined)?this.overseas_form=true:this.overseas_form=b.overseas_form;this.spouse="";this.overseas="";this.session="";this.addEvents("loadsuccess","loadfailure","submitsuccess","submitfailure","tmnsubmitted");var b={id:this.id,frame:true,title:this.title,bodyCfg:{tag:"center"},bodyStyle:"padding:0",items:[{xtype:"button",itemId:"submit_button",text:"SUBMIT",width:200,scale:"large",style:"margin:5px 0px 15px 0px",scope:this,handler:function(e,g){var c,h,d=this.items.map.authorisation_level_1_panel,f=this.items.map.authorisation_level_2_panel,i=this.items.map.authorisation_level_3_panel;if(d.isValid()&&f.isValid()&&i.isValid()){c=this.prepareData(this.data);h=this.prepareAuthorisers(d.getData(),f.getData(),i.getData());Ext.Ajax.request({url:this.submit_url,params:{session:this.getSession(),authorisers:Ext.util.JSON.encode(h),data:Ext.util.JSON.encode(c)},success:function(l,m){var k=Ext.decode(l.responseText);if(k.success==true){this.fireEvent("tmnsubmitted");this.getComponent("submit_button").disable();Ext.MessageBox.show({icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.OK,closable:false,title:"Thank You",msg:"Your TMN has been successfully submitted for approval. You will recieve updates on its approval at the following email address: "+k.email+"."})}else{var k=Ext.decode(l.responseText),j=false,n;if(k.alert!==undefined){n=k.alert}else{n="Your submission process didn't work, please try again."}if(k.locked!==undefined){j=k.locked}Ext.MessageBox.show({icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,closable:false,title:"Error",msg:n});if(j){this.getComponent("submit_button").disable()}}},failure:function(l,m){var k=Ext.decode(l.responseText),j=false,n;if(k.alert!==undefined){n=k.alert}else{n="Your submission process didn't work, please try again."}if(k.locked!==undefined){j=k.locked}Ext.MessageBox.show({icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,closable:false,title:"Error",msg:n});if(j){this.getComponent("submit_button").disable()}},scope:this})}else{Ext.MessageBox.show({icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,closable:false,title:"Error",msg:"You haven't selected all your authorisers. Please do that before you submit."})}}},new tmn.view.AuthorisationPanel(this,{id:"authorisation_level_3_panel",title:"Authorisation Level Three",leader:"Level 3",mode:"level_3"}),new tmn.view.AuthorisationPanel(this,{id:"authorisation_level_2_panel",title:"Authorisation Level Two",leader:"Level 2",mode:"level_2"}),new tmn.view.AuthorisationPanel(this,{id:"authorisation_level_1_panel",title:"Authorisation Level One",leader:"Level 1",mode:"level_1"}),new tmn.view.SummaryPanel(this,{id:"summary_panel"})]};tmn.view.PrintForm.superclass.constructor.call(this,b)};Ext.extend(tmn.view.PrintForm,Ext.Panel,{getSession:function(){return this.session},setSession:function(a){this.session=a},hasSpouse:function(){return this.spouse},setSpouse:function(a){this.spouse=a},isOverseas:function(){return this.overseas},setOverseas:function(a){this.overseas=a},parseResponse:function(a){var b={},c=null;for(id in a){form=Ext.getCmp(id);if(form.aussie_form==true&&form.overseas_form==false){if(c==null){c={}}b=Ext.util.JSON.decode(a[id]);c["aussie-based"]=b.tmn_data}else{if(form.aussie_form==false&&form.overseas_form==true&&form.home_assignment==true){if(c==null){c={}}b=Ext.util.JSON.decode(a[id]);c["home-assignment"]=b.tmn_data}else{if(form.aussie_form==false&&form.overseas_form==true&&form.home_assignment==false){if(c==null){c={}}b=Ext.util.JSON.decode(a[id]);c["international-assignment"]=b.tmn_data}}}}return c},gatherLevelReasons:function(b,c){var a={};totalReasons=0;if(b["aussie-based"]!==undefined){if(b["aussie-based"]["auth_lv"+c+"_reasons"]){a["aussie-based"]={};a["aussie-based"]["reasons"]=b["aussie-based"]["auth_lv"+c+"_reasons"];totalReasons+=a["aussie-based"]["reasons"].length}}else{if(b["home-assignment"]["auth_lv"+c+"_reasons"]!==undefined){a["home-assignment"]={};a["home-assignment"]["reasons"]=b["home-assignment"]["auth_lv"+c+"_reasons"];totalReasons+=a["home-assignment"]["reasons"].length}if(b["international-assignment"]["auth_lv"+c+"_reasons"]!==undefined){a["international-assignment"]={};a["international-assignment"]["reasons"]=b["international-assignment"]["auth_lv"+c+"_reasons"];totalReasons+=a["international-assignment"]["reasons"].length}}a.total=totalReasons;return a},prepareData:function(c){var b={transfers:null,auth_lv1:null,auth_lv1_reasons:null,auth_lv2:null,auth_lv2_reasons:null,auth_lv3:null,auth_lv3_reasons:null},a={};if(c["aussie-based"]!==undefined){a["aussie-based"]={};for(field in c["aussie-based"]){if(b[field]===undefined){a["aussie-based"][field]=c["aussie-based"][field]}}}else{a["international-assignment"]={};for(field in c["international-assignment"]){if(b[field]===undefined){a["international-assignment"][field]=c["international-assignment"][field]}}a["home-assignment"]={};for(field in c["home-assignment"]){if(b[field]===undefined){a["home-assignment"][field]=c["home-assignment"][field]}}}return a},prepareAuthorisers:function(c,b,a){var d={};d.level_1=c;d.level_2=b;d.level_3=a;return d},loadForm:function(d){this.getComponent("submit_button").enable();if(d!==undefined){var c=this.parseResponse(d),f=this.gatherLevelReasons(c,2),b=this.gatherLevelReasons(c,3),a=this.items.map.summary_panel,e=this.items.map.authorisation_level_2_panel,g=this.items.map.authorisation_level_3_panel;this.data=c;if(b.total>0){if(g.body!==undefined){g.showPanel(b)}else{g.on("afterrender",g.showPanel.createDelegate(g,[b]))}}else{if(g.body!==undefined){g.showUnusedPanel()}else{g.on("afterrender",g.showUnusedPanel)}}if(b.total>0||f.total>0){if(e.body!==undefined){e.showPanel(f)}else{e.on("afterrender",e.showPanel.createDelegate(e,[f]))}}else{if(e.body!==undefined){e.showUnusedPanel()}else{e.on("afterrender",e.showUnusedPanel)}}if(c!=null){if(a.body!==undefined){a.renderSummary(c,this.isOverseas(),this.hasSpouse())}else{a.on("afterrender",a.renderSummary.createDelegate(a,[c,this.isOverseas(),this.hasSpouse()]))}}else{this.showDataErrorMsg()}}else{this.showDataErrorMsg()}},showDataErrorMsg:function(){Ext.MessageBox.show({icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,closable:false,title:"Error",msg:'This form was loaded with invalid data. Please refresh your page and try again. If the problem doesn\'t go away, Please Contact The Technology Team at <a href="mailto:tech.team@ccca.org.au">tech.team@ccca.org.au</a>'})},onLoadSuccess:function(a,b){},onLoadFailure:function(a,b){},submitForm:function(){this.items.map.summary_panel.printSummary()},onSubmitSuccess:function(a,b){},onSubmitFailure:function(a,b){}});Ext.ns("tmn","tmn.view");tmn.view.InternalTransfers=function(a){a=a||{itemId:"internal_transfers_panel",title:"Internal Transfers",load_url:"php/imp/internal_transfers.php",add_url:"php/imp/internal_transfers.php",remove_url:"php/imp/internal_transfers.php",update_url:"php/imp/internal_transfers.php"};this.itemId=a.itemId||"internal_transfers_panel";this.title=a.title||"Internal Transfers";this.load_url=a.load_url||"php/imp/internal_transfers.php";this.add_url=a.add_url||"php/imp/internal_transfers.php";this.remove_url=a.remove_url||"php/imp/internal_transfers.php";this.update_url=a.update_url||"php/imp/internal_transfers.php";this.session=null;this.saved=true;this.setParams=function(d,f,c,e,b){e.params.session=this.getSession();switch(f){case"create":e.params.mode="add";break;case"update":e.params.mode="update";break;case"destroy":e.params.mode="remove";break;default:break}};this.Transfer=Ext.data.Record.create([{name:"transfer_id",type:"int"},{name:"transfer_name",type:"string"},{name:"transfer_amount",type:"int"}]);this.Writer=new Ext.data.JsonWriter({encode:true,encodeDelete:true,writeAllFields:true});this.Reader=new Ext.data.JsonReader({idProperty:"transfer_id",root:"transfers",fields:this.Transfer});this.Proxy=new Ext.data.HttpProxy({api:{read:{url:this.load_url,method:"POST"},create:{url:this.add_url,method:"POST"},update:{url:this.update_url,method:"POST"},destroy:{url:this.remove_url,method:"POST"}}});this.config={itemId:this.itemId,title:this.title,height:200,clicksToEdit:1,selModel:new Ext.grid.RowSelectionModel({singleSelect:true}),store:new Ext.data.Store({itemId:"internal_transfers_store",autoDestroy:true,proxy:this.Proxy,reader:this.Reader,writer:this.Writer,autoSave:false,batch:true,listeners:{beforewrite:this.setParams,exception:function(e,f,g,c,d,b){},scope:this}}),colModel:new Ext.grid.ColumnModel({defaults:{width:120},columns:[{header:"Transfer Name",dataIndex:"transfer_name",editor:new Ext.form.TextField({allowBlank:false})},{header:"Transfer Amount",dataIndex:"transfer_amount",editor:new Ext.form.NumberField({allowBlank:false,minValue:0})}]}),tbar:[{itemId:"add",text:"Add",iconCls:"silk-add",scope:this,handler:function(e,f){this.saved=false;var d=this;var c=this.getStore();var b=new c.recordType({transfer_name:"",transfer_amount:0});d.stopEditing(true);index=d.getStore().getCount();d.getStore().insert(index,b);d.getSelectionModel().selectLastRow(false);d.startEditing(index,0);e.disable()}},"-",{itemId:"remove",text:"Remove",iconCls:"silk-delete",scope:this,handler:function(){this.saved=false;var c=this;if(c.getSelectionModel().getCount()>0){c.stopEditing(true);var b=c.getSelectionModel().getSelected();c.getStore().remove(b);c.getSelectionModel().selectLastRow(false);this.getTopToolbar().items.map.add.enable();this.getTopToolbar().items.map.remove.enable()}}}],listeners:{scope:this,afteredit:function(b){this.saved=false;var d=b.record;if(d.data.transfer_name!=""&&d.data.transfer_amount!=0){this.getTopToolbar().items.map.add.enable();this.getTopToolbar().items.map.remove.enable()}var c=this.getStore().getRange();if(c.data!==undefined){c=[c]}for(recordCount=0;recordCount<c.length;recordCount++){record=c[recordCount];if(record!=0&&record!==undefined){if(d.id!=record.id&&d.data.transfer_name==record.data.transfer_name){if(d.data.transfer_amount>0){record.set("transfer_amount",record.data.transfer_amount+d.data.transfer_amount)}this.getStore().remove(d);Ext.Msg.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Naming Error",msg:"You can't have two transfers with the same name. The amount from the transfer you just created has been added to the existing transfer with the same name."});this.getTopToolbar().items.map.add.enable();this.getTopToolbar().items.map.remove.enable();break}}}}}};tmn.view.InternalTransfers.superclass.constructor.call(this,this.config)};Ext.extend(tmn.view.InternalTransfers,Ext.grid.EditorGridPanel,{isSaved:function(){return this.saved},getSession:function(){return this.session},setSession:function(a){this.session=a},loadInternalTransfers:function(a){this.resetInternalTransfers();this.setSession(a);this.getStore().load({params:{mode:"get",session:this.getSession()},add:false,scope:this,callback:function(b,c,d){this.getTopToolbar().items.map.add.enable();this.getTopToolbar().items.map.remove.enable()}});this.saved=true},saveInternalTransfers:function(){this.getStore().save();this.saved=true},saveAsInternalTransfers:function(a){this.setSession(a);var b=this.getTransferArray();Ext.Ajax.request({url:this.update_url,scope:this,params:{mode:"saveas",session:this.getSession(),transfers:Ext.encode(b)},success:function(c){this.loadInternalTransfers(this.getSession());this.saved=true}})},deleteInternalTransfers:function(){Ext.Ajax.request({url:this.update_url,scope:this,params:{mode:"deleteall",session:this.getSession()},success:function(a){this.resetInternalTransfers()}})},getTransferArray:function(){var b=[];var a=this.getStore().getRange();if(a.data!==undefined){a=[a]}for(recordCount=0;recordCount<a.length;recordCount++){b[recordCount]=a[recordCount].data}return b},resetInternalTransfers:function(){this.setSession(null);this.getStore().removeAll();this.getStore().removed=[];this.getStore().modified=[];this.saved=true}});Ext.ns("tmn","tmn.view");tmn.view.LastTMN=new Ext.Window({title:"TMN - 2009",closable:false,width:418,height:436,resizable:false});tmn.view.FinancialDetailsForm=function(a,b){this.view=a||{};b=b||{};this.saved=true;this.locked=false;this.processingAllowed=true;this.id=b.id||"financial_details_form";this.title=b.title||"Financial Details";this.crud_url=b.crud_url||"php/imp/session_crud.php";this.load_url=b.load_url||"php/load_financial_details.php";this.submit_url=b.submit_url||"php/submit_financial_details.php";this.keyup_timeout=b.keyup_timeout||1000;this.home_assignment;this.aussie_form;this.overseas_form;(b.home_assignment===undefined)?this.home_assignment=false:this.home_assignment=b.home_assignment;(b.aussie_form===undefined)?this.aussie_form=true:this.aussie_form=b.aussie_form;(b.overseas_form===undefined)?this.overseas_form=false:this.overseas_form=b.overseas_form;this.addEvents("financialdataupdated","resetfinancialdata","loadsuccess","loadfailure","submitsuccess","submitfailure","loadsession","loadsessionsuccess","savesession","saveassession","saveassessionsuccess","deletesession","deletesessionsuccess","resetsession");this.config={id:this.id,frame:true,title:this.title,tbar:new Ext.ux.StatusBar({defaultText:"Ready",plugins:new Ext.ux.ValidationStatus({form:this.id}),statusAlign:"right",items:[" "," ","Session:         "," ",new Ext.ux.IconCombo({itemId:"session_combo",width:200,fieldLabel:"Session",valueField:"SESSION_ID",hiddenName:"SESSION_COMBO",hiddenId:"SESSION_COMBO",displayField:"SESSION_NAME",lockedField:"LOCKED",emptyText:"Select a Session or start typing...",triggerAction:"all",editable:false,forceSelection:true,allowBlank:true,mode:"local",store:new Ext.data.JsonStore({itemId:"session_store",root:"Tmn_Sessions",storeId:"SESSION_ID",fields:["SESSION_ID","SESSION_NAME","LOCKED"],url:"php/imp/combofill.php",baseParams:{mode:"Tmn_Sessions",aussie_form:this.aussie_form,home_assignment:this.home_assignment,overseas_form:this.overseas_form},autoLoad:true}),listeners:{scope:this,select:function(e,c,d){this.fireEvent("loadsession",this)}}})," ","-"," ",{itemId:"save_session_button",text:"Save",width:80,scope:this,handler:function(){this.fireEvent("savesession",this)}}," ","-"," ",{itemId:"saveas_session_button",text:"Save As",width:80,scope:this,handler:function(){this.fireEvent("saveassession",this)}}," ","-"," ",{itemId:"delete_session_button",text:"Delete",width:80,scope:this,handler:function(){this.fireEvent("deletesession",this)}}," ","-"," ",{itemId:"reset_session_button",text:"Reset",width:80,scope:this,handler:function(){this.fireEvent("resetsession",this)}}," ","-"]}),items:[{itemId:"os_assignment_panel",layout:"form",title:"Dates of "+this.title,labelWidth:150,bodyStyle:"padding:10px",defaultType:"datefield",items:[{itemId:"os_assignment_start_date",fieldLabel:"Start Date",name:"OS_ASSIGNMENT_START_DATE",format:"d-m-Y",allowBlank:false,editable:false,vtype:"daterange",endDateField:function(){return this.getForm().items.map.os_assignment_end_date}.createDelegate(this),listeners:{scope:this,select:function(d,c){this.fireEvent("financialdataupdated",this,d,c.format("d-m-Y"),false)}}},{itemId:"os_assignment_end_date",fieldLabel:"End Date",name:"OS_ASSIGNMENT_END_DATE",format:"d-m-Y",allowBlank:false,editable:false,vtype:"daterange",startDateField:function(){return this.getForm().items.map.os_assignment_start_date}.createDelegate(this),listeners:{scope:this,select:function(d,c){this.fireEvent("financialdataupdated",this,d,c.format("d-m-Y"),false)}}}]},{itemId:"taxable_income_panel",layout:"column",buttonAlign:"right",defaults:{defaultType:"numberfield",bodyStyle:"padding:10px",defaults:{allowBlank:false,minValue:0}},items:[{itemId:"my",columnWidth:0.5,layout:"form",title:"My Taxable Income",items:[{itemId:"stipend",name:"STIPEND",fieldLabel:"Stipend",listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the estimated amount that will go into your bank account each month.<br />This will be approximately half of your total Finanacial Package when you have included your MFB's."})}}},{itemId:"hs",xtype:"panel",layout:"form",defaultType:"numberfield",defaults:{allowBlank:false,minValue:0},items:[{itemId:"housing_stipend",name:"HOUSING_STIPEND",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Housing Stipend",value:0,listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the extra amount that needs to be added to your Stipend to cover your housing.<br />This happens when your MFBs don't fully cover your housing requirements."})}}}]},{itemId:"fi",xtype:"panel",layout:"form",defaultType:"numberfield",defaults:{allowBlank:false,minValue:0},items:[{itemId:"taxable_future_investment",name:"TAXABLE_FUTURE_INVESTMENT",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Taxable Future Investment",value:0,listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the 9% of your stipend that goes toward your Future Investment e.g. First Home Saver Account. If you would like to put more toward your Future Investment please just increase your Stipend and notify the Finance Department of where you want it to go."})}}}]},{itemId:"ns",xtype:"panel",layout:"form",defaultType:"numberfield",defaults:{allowBlank:false,minValue:0},items:[{itemId:"net_stipend",name:"NET_STIPEND",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Net Stipend",value:0,listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the estimated amount that will go into your bank account each month plus your housing stipend.<br />This will be approximately half of your total Finanacial Package when you have included your MFB's."})}}}]},{itemId:"post_tax_super",name:"POST_TAX_SUPER",fieldLabel:"Post Tax Super",value:0,listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:'Record the amount of post-tax voluntary superannuation contribution you would like to be paid.<br />To ensure you are eligible for the superannuation co-contribution scheme, go to <a href="http://www.ato.gov.au/individuals/content.asp?doc=/content/42616.htm&page=1&H1" target="_blank">the ATO website</a>.<br />You may be eligible to receive up to $84/month.'})}}},{itemId:"additional_tax",name:"ADDITIONAL_TAX",fieldLabel:"Additional Tax",value:0,listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Most people will leave this field blank. CCCA will deduct the appropriate amount of tax.<br />Only record Additional Tax if you want <b>extra</b> tax deducted each month (e.g. to cover investment income)."})}}},{itemId:"tax",name:"TAX",readOnly:true,cls:"x-form-readonly",fieldLabel:"Tax",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the amount of tax that is required for the specified stipend.<br /><b><i>This will be automatically calculated</i></b>."})}}},{itemId:"taxable_income",name:"TAXABLE_INCOME",readOnly:true,cls:"x-form-readonly",fieldLabel:"Taxable Income",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is your taxable income consisting of the sum of the above fields, it is used for tax purposes.<br /><b><i>This will be automatically calculated</i></b>."})}}}]},{itemId:"spouse",columnWidth:0.5,layout:"form",title:"Spouse Taxable Income",items:[{itemId:"s_stipend",name:"S_STIPEND",fieldLabel:"Stipend",listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the estimated amount that will go into your bank account each month.<br />This will be approximately half of your total Finanacial Package when you have included your MFB's."})}}},{itemId:"hs",xtype:"panel",layout:"form",defaultType:"numberfield",defaults:{allowBlank:false,minValue:0},items:[{itemId:"s_housing_stipend",name:"S_HOUSING_STIPEND",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Housing Stipend",value:0,listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the extra amount that needs to be added to your Stipend to cover your housing.<br />This happens when your MFBs don't fully cover your housing requirements."})}}}]},{itemId:"fi",xtype:"panel",layout:"form",defaultType:"numberfield",defaults:{allowBlank:false,minValue:0},items:[{itemId:"s_taxable_future_investment",name:"S_TAXABLE_FUTURE_INVESTMENT",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Taxable Future Investment",value:0,listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the 9% of your stipend that goes toward your Future Investment e.g. First Home Saver Account. If you would like to put more toward your Future Investment please just increase your Stipend and notify the Finance Department of where you want it to go."})}}}]},{itemId:"ns",xtype:"panel",layout:"form",defaultType:"numberfield",defaults:{allowBlank:false,minValue:0},items:[{itemId:"s_net_stipend",name:"S_NET_STIPEND",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Net Stipend",value:0,listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the estimated amount that will go into your bank account each month plus your housing stipend.<br />This will be approximately half of your total Finanacial Package when you have included your MFB's."})}}}]},{itemId:"s_post_tax_super",name:"S_POST_TAX_SUPER",fieldLabel:"Post Tax Super",value:0,listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:'Record the amount of post-tax voluntary superannuation contribution you would like to be paid.<br />To ensure you are eligible for the superannuation co-contribution scheme, go to <a href="http://www.ato.gov.au/individuals/content.asp?doc=/content/42616.htm&page=1&H1" target="_blank">the ATO website</a>.<br />You may be eligible to receive up to $84/month.'})}}},{itemId:"s_additional_tax",name:"S_ADDITIONAL_TAX",fieldLabel:"Additional Tax",value:0,listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Most people will leave this field blank. CCCA will deduct the appropriate amount of tax.<br />Only record Additional Tax if you want <b>extra</b> tax deducted each month (e.g. to cover investment income)."})}}},{itemId:"s_tax",name:"S_TAX",readOnly:true,cls:"x-form-readonly",fieldLabel:"Tax",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the amount of tax that is required for the specified stipend.<br /><b><i>This will be automatically calculated</i></b>."})}}},{itemId:"s_taxable_income",name:"S_TAXABLE_INCOME",readOnly:true,cls:"x-form-readonly",fieldLabel:"Taxable Income",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is your taxable income consisting of the sum of the above fields, it is used for tax purposes.<br /><b><i>This will be automatically calculated</i></b>."})}}}]},{itemId:"os_residency",columnWidth:1,layout:"form",header:false,labelWidth:350,items:[{itemId:"os_resident_for_tax_purposes",xtype:"combo",width:150,fieldLabel:"Are you an Australian Resident for Tax Purposes?",name:"OS_RESIDENT_FOR_TAX_PURPOSES",hiddenName:"OS_RESIDENT_FOR_TAX_PURPOSES",hiddenId:"OS_RESIDENT_FOR_TAX_PURPOSES_hidden",triggerAction:"all",emptyText:"Enter Yes or No...",validationEvent:"blur",allowBlank:false,editable:false,mode:"local",value:1,store:new Ext.data.SimpleStore({fields:["residentCode","residentName"],data:[[0,"No"],[1,"Yes"]]}),displayField:"residentName",valueField:"residentCode",listeners:{scope:this,select:function(e,c,d){this.fireEvent("financialdataupdated",this,e,d,this.processingAllowed);if(this.getForm().items.map.os_resident_for_tax_purposes.getValue()==1){this.getComponent("os_lafha_panel").show();this.getComponent("os_lafha_panel").getComponent("my").items.each(function(h,f,g){h.enable()});if(this.hasSpouse()){this.getComponent("os_lafha_panel").getComponent("spouse").items.each(function(h,f,g){h.enable()})}}else{this.getForm().items.map.os_lafha.setValue(0);this.getComponent("os_lafha_panel").getComponent("my").items.each(function(h,f,g){h.disable()});if(this.hasSpouse()){this.getComponent("os_lafha_panel").getComponent("spouse").items.each(function(h,f,g){h.disable()})}this.getComponent("os_lafha_panel").hide()}}}}]}]},{itemId:"housing_panel",layout:"form",title:"Housing",defaultType:"numberfield",bodyStyle:"padding:10px",labelWidth:300,defaults:{allowBlank:false,minValue:0,value:0},items:[{itemId:"housing",name:"HOUSING",fieldLabel:"Housing",listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Record the amount you would like to be paid from your Support Account each fortnight/month for housing.<br />If this amount can not be covered by your MFBs, your stipend will be increased. We call this amount, Housing Stipend. This is taxable income that will not go into your account but will be paid directly toward your housing."})}}},{itemId:"housing_frequency",xtype:"combo",fieldLabel:"How often would you like to be paid your housing allowance?",name:"HOUSING_FREQUENCY",hiddenName:"HOUSING_FREQUENCY",hiddenId:"HOUSING_FREQUENCY_hidden",triggerAction:"all",emptyText:"Choose a frequency...",validationEvent:"blur",editable:false,mode:"local",hiddenValue:0,store:new Ext.data.SimpleStore({fields:["housingfrequencyCode","housingfrequencyText"],data:[[0,"Monthly"],[1,"Fortnightly"]]}),displayField:"housingfrequencyText",valueField:"housingfrequencyCode",listeners:{scope:this,select:function(e,c,d){this.fireEvent("financialdataupdated",this,e,d,this.processingAllowed)}}},{itemId:"am",xtype:"panel",layout:"form",defaultType:"numberfield",defaults:{allowBlank:false,minValue:0},items:[{itemId:"additional_mortgage",name:"ADDITIONAL_MORTGAGE",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Monthly Additional Mortgage Payment",value:0,listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the Future Investment (caluclated as 9% of your stipend) that goes toward your mortgage."})}}},{itemId:"total_housing",name:"TOTAL_HOUSING",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Monthly Total Housing Payment",value:0,listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the estimated total amount that will go toward your housing."})}}}]},{itemId:"additional_housing",name:"ADDITIONAL_HOUSING",readOnly:true,cls:"x-form-readonly",fieldLabel:"Monthly Additional Housing Allowance",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Housing payments above the Maximum Housing MFB (set each year based on national median housing price) are not part of your Ministry Fringe Benifits.<br /><b><i>This will be automatically calculated</i></b>."})}}}]},{itemId:"os_overseas_housing_panel",layout:"form",title:"Overseas Housing Allowance",defaultType:"numberfield",bodyStyle:"padding:10px",defaults:{width:140,minValue:0,value:0},items:[{itemId:"os_overseas_housing",name:"OS_OVERSEAS_HOUSING",fieldLabel:"Overseas Housing Allowance",listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the amount of money needed to maintain the house you have in the country you minister in."})}}}]},{itemId:"os_lafha_panel",layout:"column",defaults:{defaultType:"numberfield",bodyStyle:"padding:10px",defaults:{width:140,allowBlank:false,minValue:0}},items:[{itemId:"my",layout:"form",columnWidth:0.5,title:"My LAFHA",items:[{itemId:"os_lafha",name:"OS_LAFHA",fieldLabel:"LAFHA",listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Living Away From Home Allowance. This is to assist you will on assignment outside of Australia. While this allowance has no limit, it is part of your Financial Package and your Financial Package does."})}}}]},{itemId:"spouse",layout:"form",columnWidth:0.5,title:"Spouse LAFHA",items:[{itemId:"s_os_lafha",name:"S_OS_LAFHA",fieldLabel:"LAFHA",listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Living Away From Home Allowance. This is to assist you will on assignment outside of Australia. While this allowance has no limit, it is part of your Financial Package and your Financial Package does."})}}}]}]},{itemId:"mfb_panel",layout:"column",defaults:{defaultType:"numberfield",bodyStyle:"padding:10px",defaults:{width:140,allowBlank:false,minValue:0}},items:[{itemId:"my",layout:"form",columnWidth:0.5,title:"My MFB",items:[{itemId:"mfb_rate",xtype:"combo",fieldLabel:"MFB Rate",name:"MFB_RATE",hiddenName:"MFB_RATE",hiddenId:"MFB_RATE_hidden",triggerAction:"all",emptyText:"Enter Rate...",validationEvent:"blur",allowBlank:false,editable:false,mode:"local",hiddenValue:2,value:2,store:new Ext.data.SimpleStore({fields:["mfbRateCode","mfbRateText"],data:[[0,"Zero MFBs"],[1,"Half MFBs"],[2,"Full MFBs"]]}),displayField:"mfbRateText",valueField:"mfbRateCode",listeners:{scope:this,select:function(e,c,d){this.fireEvent("financialdataupdated",this,e,d,this.processingAllowed)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Please select the MFB rate allowed for your role at CCCA."})}}},{itemId:"max_mfb",name:"MFB",readOnly:true,cls:"x-form-readonly",fieldLabel:"MFB",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is your Ministry Fringe Benefits. It will be automatically set to the maximum that you are allowed.<br />If you would like to claim more MFB, increase your Taxable Income."})}}},{itemId:"claimable_mfb",name:"CLAIMABLE_MFB",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Claimable MFBs",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the amount of your Ministry Fringe Benefits that you can make claims from once your housing has been deducted.<br />It will be automatically set to the maximum that you are allowed.<br />If you would like to claim more MFB, increase your Stipend."})}}}]},{itemId:"spouse",layout:"form",columnWidth:0.5,title:"Spouse MFB",items:[{itemId:"s_mfb_rate",xtype:"combo",fieldLabel:"MFB Rate",name:"S_MFB_RATE",hiddenName:"S_MFB_RATE",hiddenId:"S_MFB_RATE_hidden",triggerAction:"all",emptyText:"Enter Rate...",validationEvent:"blur",allowBlank:false,editable:false,mode:"local",hiddenValue:2,value:2,store:new Ext.data.SimpleStore({fields:["mfbRateCode","mfbRateText"],data:[[0,"Zero MFBs"],[1,"Half MFBs"],[2,"Full MFBs"]]}),displayField:"mfbRateText",valueField:"mfbRateCode",listeners:{scope:this,select:function(e,c,d){this.fireEvent("financialdataupdated",this,e,d,this.processingAllowed)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Please select the MFB rate allowed for your role at CCCA."})}}},{itemId:"s_max_mfb",name:"S_MFB",readOnly:true,cls:"x-form-readonly",fieldLabel:"MFB",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is your Ministry Fringe Benefits. It will be automatically set to the maximum that you are allowed.<br />If you would like to claim more MFB, increase your Taxable Income."})}}},{itemId:"s_claimable_mfb",name:"S_CLAIMABLE_MFB",readOnly:true,cls:"x-form-readonly-red",fieldLabel:"Claimable MFBs",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the amount of your Ministry Fringe Benefits that you can make claims from once your housing has been deducted.<br />It will be automatically set to the maximum that you are allowed.<br />If you would like to claim more MFB, increase your Taxable Income."})}}}]}]},{itemId:"super_panel",layout:"column",defaults:{defaultType:"numberfield",bodyStyle:"padding:10px",defaults:{allowBlank:false,minValue:0}},items:[{itemId:"my",layout:"form",title:"My Super Details",columnWidth:0.5,items:[{itemId:"future_investment_panel",xtype:"panel",layout:"form",items:[{width:140,itemId:"future_investment_mode",xtype:"combo",fieldLabel:"Where do you want your Future Investment to go?",name:"FUTURE_INVESTMENT_MODE",hiddenName:"FUTURE_INVESTMENT_MODE",hiddenId:"FUTURE_INVESTMENT_MODE_hidden",triggerAction:"all",emptyText:"Pre-tax super...",validationEvent:"blur",allowBlank:false,editable:false,mode:"local",hiddenValue:0,value:"Pre-Tax Super",store:new Ext.data.SimpleStore({fields:["futureInvestmentCode","futureInvestmentName"],data:[[0,"Pre-Tax Super"],[1,"Mortgage"],[2,"First Home Saver Account"]]}),displayField:"futureInvestmentName",valueField:"futureInvestmentCode",listeners:{scope:this,select:function(e,c,d){if(d!=0){this.getComponent("super_panel").getComponent("my").getComponent("pre_tax_super_panel").getComponent("pre_tax_super_mode").toggle(false)}Ext.Msg.alert("FUTURE INVESTMENT Change!",'<b>You have changed where your FUTURE INVESTMENT goes.<br /><br />FOR THIS TO TAKE EFFECT YOU MUST SUBMIT THE FUTURE INVESTMENT FORM TO FINANCE!<br /><br />Click <a href="pdf/future_investment.pdf" target="_blank">here</a> to download the Future Investment form.');this.fireEvent("financialdataupdated",this,e,d,true)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"9% of your Taxable Income goes toward your Super Fund. This is a compulsary amount enforced by the government. As missionaries we also get MFBs. The government does not require a compulsary percentage of your MFBs to go toward your Super Fund. However, to look after you CCCA requires you, as a minimum, to set aside another 9% of your stipend (for someone on Half-MFBs it would be 4.5% of your Stipend, for somone on Zero-MFBs it would be 0% of your Stipend) toward your future. This amount is called your Future Investment. You may add more than the minimum and you can select where it goes using this combo box."})}}}]},{itemId:"pre_tax_super_panel",xtype:"panel",layout:"form",items:[{xtype:"numberfield",itemId:"pre_tax_super",name:"PRE_TAX_SUPER",cls:"x-form-readonly",fieldLabel:"Pre Tax Super",value:0,minValue:0,allowBlank:false,enableKeyEvents:true,listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Record the amount of Pre-tax Super you would like to be paid from your Support Account each month.<br />This amount is not Taxed."})}}},{xtype:"button",itemId:"pre_tax_super_mode",enableToggle:true,text:"Manually Set Pre Tax Super",margins:{top:0,right:0,bottom:10,left:100},scope:this,toggleHandler:function(c,d){if(d==true){this.getForm().items.map.pre_tax_super.purgeListeners();this.getForm().items.map.pre_tax_super.removeClass("x-form-readonly");this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"pre_tax_super_mode"}},"manual",this.processingAllowed);this.getForm().items.map.pre_tax_super.enableKeyEvents=true;this.getForm().items.map.pre_tax_super.addListener("keyup",function(f,e){this.fireEvent("financialdataupdated",this,f,f.getValue(),this.processingAllowed)},this,{buffer:this.keyup_timeout})}else{this.getForm().items.map.pre_tax_super.purgeListeners();this.getForm().items.map.pre_tax_super.addClass("x-form-readonly");this.getForm().items.map.pre_tax_super.enableKeyEvents=false;this.getForm().items.map.pre_tax_super.addListener("focus",function(e){e.blur()});this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"pre_tax_super_mode"}},"auto",this.processingAllowed)}}}]},{itemId:"employer_super",name:"EMPLOYER_SUPER",readOnly:true,cls:"x-form-readonly",fieldLabel:"Employer Super",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the required employer super contribution.<br /><b><i>This will be automatically calculated</i></b>."})}}},{width:140,itemId:"super_fund",xtype:"combo",fieldLabel:"Is your super fund IOOF?",name:"SUPER_FUND",hiddenName:"SUPER_FUND",hiddenId:"SUPER_FUND_hidden",triggerAction:"all",emptyText:"Enter Yes or No...",validationEvent:"blur",allowBlank:false,editable:false,mode:"local",hiddenValue:1,value:"Yes",store:new Ext.data.SimpleStore({fields:["ioofCode","ioofName"],data:[[0,"No"],[1,"Yes"]]}),displayField:"ioofName",valueField:"ioofCode",listeners:{scope:this,select:function(e,c,d){if(d==1){e.nextSibling().expand()}else{e.nextSibling().collapse();Ext.Msg.alert("Super Fund Change!",'If you are changing your Super Fund you need to fill out <a href="pdf/superfund_change.pdf" target="_blank">this</a> form for the change to apply.')}this.fireEvent("financialdataupdated",this,e,d,false)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Select whether you have nominated IOOF for your super fund or not.<br /><b>If you select differently to your previous TMN form, the changes will <i>NOT</i> be automatic: you must contact Member Care and submit a super nomination form.</b>"})}}},{itemId:"additional_life_cover_panel",xtype:"panel",layout:"form",defaults:{width:140},items:[{itemId:"additional_life_cover",xtype:"combo",fieldLabel:"Weekly Life Cover Amount",name:"ADDITIONAL_LIFE_COVER",hiddenName:"ADDITIONAL_LIFE_COVER",hiddenId:"ADDITIONAL_LIFE_COVER_hidden",triggerAction:"all",emptyText:"Enter Amount of Life Cover...",validationEvent:"blur",editable:false,mode:"local",hiddenValue:0,value:"$1",store:new Ext.data.SimpleStore({fields:["lifecoverCode","lifecoverText"],data:[[0,"$1"],[1,"$2"],[2,"$3"],[3,"$4"],[4,"$5"],[5,"$6"],[6,"$7"],[7,"$8"],[8,"$9"],[9,"$10"]]}),displayField:"lifecoverText",valueField:"lifecoverCode",listeners:{scope:this,select:function(e,c,d){Ext.Msg.alert("Life Cover Change!",'If you are changing your Life Cover you need to fill out <a href="pdf/ioof_lifecover_change.zip" target="_blank">this</a> form for the change to apply.');this.fireEvent("financialdataupdated",this,e,d,this.processingAllowed)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"<b>Note:</b> This is a weekly figure.<br />CCCA will pay $1/week. If you would like additional Life Cover (on top of the $1/week) record the total amount (including the $1/week to a maximum of $10/week).<br /><b>If you select differently to your previous TMN form, the changes will <i>NOT</i> be automatic: you must contact Member Care and submit a Life Cover Change form.</b>"})}}}]},{width:140,itemId:"income_protection_cover_source",xtype:"combo",fieldLabel:"Where should your Income Protection Cover be taken from?",name:"INCOME_PROTECTION_COVER_SOURCE",hiddenName:"INCOME_PROTECTION_COVER_SOURCE",hiddenId:"INCOME_PROTECTION_COVER_SOURCE_hidden",triggerAction:"all",emptyText:"Enter Source of the Income Protection Cover...",validationEvent:"blur",editable:false,mode:"local",hiddenValue:0,value:"Support Account",store:new Ext.data.SimpleStore({fields:["lifecoversourceCode","lifecoversourceText"],data:[[0,"Support Account"],[1,"Super Fund"]]}),displayField:"lifecoversourceText",valueField:"lifecoversourceCode",listeners:{scope:this,select:function(e,c,d){Ext.Msg.alert("INCOME PROTECTION Cover Change!",'<b>You have changed where your INCOME PROTECTION Cover is taken from.<br /><br />Note:<br />This cover is <i>DIFFERENT</i> to your Life Cover.<br />Click <a href="https://www.mygcx.org/CCCAMemberPortal/file/225/Insurance_calc.xls" target="_blank">here</a> to download Income Protection Cover calculator.<br />Your Income Protection Cover is taken out annually and can be quite a large amount and can have a <i>significant</i> impact on the account it comes from.<br />So choose carefully!</b>');this.fireEvent("financialdataupdated",this,e,d,false)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:'Nominate where your Income Protection Cover should be taken from.<br /><b>This cover is <i>DIFFERENT</i> to your Life Cover.</b><br />Click <a href="https://www.mygcx.org/CCCAMemberPortal/file/225/Insurance_calc.xls" target="_blank">here</a> to download Income Protection Cover calculator.<br />Your Income Protection Cover is taken out annually and can be quite a large amount and can have a <i>significant</i> impact on the account it comes from.<br />So choose carefully!'})}}}]},{itemId:"spouse",layout:"form",title:"Spouse Super Details",columnWidth:0.5,items:[{itemId:"future_investment_panel",xtype:"panel",layout:"form",items:[{width:140,itemId:"s_future_investment_mode",xtype:"combo",fieldLabel:"Where do you want your Future Investment to go?",name:"S_FUTURE_INVESTMENT_MODE",hiddenName:"S_FUTURE_INVESTMENT_MODE",hiddenId:"S_FUTURE_INVESTMENT_MODE_hidden",triggerAction:"all",emptyText:"Pre-tax super...",validationEvent:"blur",allowBlank:false,editable:false,mode:"local",hiddenValue:0,value:"Pre-Tax Super",store:new Ext.data.SimpleStore({fields:["futureInvestmentCode","futureInvestmentName"],data:[[0,"Pre-Tax Super"],[1,"Mortgage"],[2,"First Home Saver Account"]]}),displayField:"futureInvestmentName",valueField:"futureInvestmentCode",listeners:{scope:this,select:function(e,c,d){if(d!=0){this.getComponent("super_panel").getComponent("spouse").getComponent("pre_tax_super_panel").getComponent("s_pre_tax_super_mode").toggle(false)}Ext.Msg.alert("FUTURE INVESTMENT Change!",'<b>You have changed where your FUTURE INVESTMENT goes.<br /><br />FOR THIS TO TAKE EFFECT YOU MUST SUBMIT THE FUTURE INVESTMENT FORM TO FINANCE!<br /><br />Click <a href="pdf/future_investment.pdf" target="_blank">here</a> to download the Future Investment form.');this.fireEvent("financialdataupdated",this,e,d,true)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"9% of your Taxable Income goes toward your Super Fund. This is a compulsary amount enforced by the government. As missionaries we also get MFBs. The government does not require a compulsary percentage of your MFBs to go toward your Super Fund. However, to look after you CCCA requires you, as a minimum, to set aside another 9% of your stipend (for someone on Half-MFBs it would be 4.5% of your Stipend, for somone on Zero-MFBs it would be 0% of your Stipend) toward your future. This amount is called your Future Investment. You may add more than the minimum and you can select where it goes using this combo box."})}}}]},{itemId:"pre_tax_super_panel",xtype:"panel",layout:"form",items:[{xtype:"numberfield",itemId:"s_pre_tax_super",name:"S_PRE_TAX_SUPER",cls:"x-form-readonly",fieldLabel:"Pre Tax Super",value:0,minValue:0,allowBlank:false,enableKeyEvents:true,listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Record the amount of Pre-tax Super you would like to be paid from your Support Account each month.<br />This amount is not Taxed."})}}},{xtype:"button",itemId:"s_pre_tax_super_mode",enableToggle:true,text:"Manually Set Pre Tax Super",margins:{top:0,right:0,bottom:3,left:0},scope:this,toggleHandler:function(c,d){if(d==true){this.getForm().items.map.s_pre_tax_super.purgeListeners();this.getForm().items.map.s_pre_tax_super.removeClass("x-form-readonly");this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"s_pre_tax_super_mode"}},"manual",this.processingAllowed);this.getForm().items.map.s_pre_tax_super.enableKeyEvents=true;this.getForm().items.map.s_pre_tax_super.addListener("keyup",function(f,e){this.fireEvent("financialdataupdated",this,f,f.getValue(),this.processingAllowed)},this,{buffer:this.keyup_timeout})}else{this.getForm().items.map.s_pre_tax_super.purgeListeners();this.getForm().items.map.s_pre_tax_super.addClass("x-form-readonly");this.getForm().items.map.s_pre_tax_super.enableKeyEvents=false;this.getForm().items.map.s_pre_tax_super.addListener("focus",function(e){e.blur()});this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"s_pre_tax_super_mode"}},"auto",this.processingAllowed)}}}]},{itemId:"s_employer_super",name:"S_EMPLOYER_SUPER",readOnly:true,cls:"x-form-readonly",fieldLabel:"Employer Super",listeners:{focus:function(c){c.blur()},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the required employer super contribution.<br /><b><i>This will be automatically calculated</i></b>."})}}},{width:140,itemId:"s_super_fund",xtype:"combo",fieldLabel:"Is your super fund IOOF?",name:"S_SUPER_FUND",hiddenName:"S_SUPER_FUND",hiddenId:"S_SUPER_FUND_hidden",triggerAction:"all",emptyText:"Enter Yes or No...",validationEvent:"blur",allowBlank:false,editable:false,mode:"local",hiddenValue:1,value:"Yes",store:new Ext.data.SimpleStore({fields:["ioofCode","ioofName"],data:[[0,"No"],[1,"Yes"]]}),displayField:"ioofName",valueField:"ioofCode",listeners:{scope:this,select:function(e,c,d){if(d==1){e.nextSibling().expand()}else{e.nextSibling().collapse();Ext.Msg.alert("Super Fund Change!",'If you are changing your Super Fund you need to fill out <a href="pdf/superfund_change.pdf" target="_blank">this</a> form for the change to apply.')}this.fireEvent("financialdataupdated",this,e,d,false)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Select whether you have nominated IOOF for your super fund or not.<br /><b>If you select differently to your previous TMN form, the changes will <i>NOT</i> be automatic: you must contact Member Care and submit a super nomination form.</b>"})}}},{itemId:"s_additional_life_cover_panel",xtype:"panel",layout:"form",defaults:{width:140},items:[{itemId:"s_additional_life_cover",xtype:"combo",fieldLabel:"Weekly Life Cover Amount",name:"S_ADDITIONAL_LIFE_COVER",hiddenName:"S_ADDITIONAL_LIFE_COVER",hiddenId:"S_ADDITIONAL_LIFE_COVER_hidden",triggerAction:"all",emptyText:"Enter Amount of Life Cover...",validationEvent:"blur",editable:false,mode:"local",hiddenValue:0,value:"$1",store:new Ext.data.SimpleStore({fields:["lifecoverCode","lifecoverText"],data:[[0,"$1"],[1,"$2"],[2,"$3"],[3,"$4"],[4,"$5"],[5,"$6"],[6,"$7"],[7,"$8"],[8,"$9"],[9,"$10"]]}),displayField:"lifecoverText",valueField:"lifecoverCode",listeners:{scope:this,select:function(e,c,d){Ext.Msg.alert("Life Cover Change!",'If you are changing your Life Cover you need to fill out <a href="pdf/ioof_lifecover_change.zip" target="_blank">this</a> form for the change to apply.');this.fireEvent("financialdataupdated",this,e,d,this.processingAllowed)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"<b>Note:</b> This is a weekly figure.<br />CCCA will pay $1/week. If you would like additional Life Cover (on top of the $1/week) record the total amount (including the $1/week to a maximum of $10/week).<br /><b>If you select differently to your previous TMN form, the changes will <i>NOT</i> be automatic: you must contact Member Care and submit a Life Cover Change form.</b>"})}}}]},{width:140,itemId:"s_income_protection_cover_source",xtype:"combo",fieldLabel:"Where should your Income Protection Cover be taken from?",name:"S_INCOME_PROTECTION_COVER_SOURCE",hiddenName:"S_INCOME_PROTECTION_COVER_SOURCE",hiddenId:"S_INCOME_PROTECTION_COVER_SOURCE_hidden",triggerAction:"all",emptyText:"Enter Source of the Income Protection Cover...",validationEvent:"blur",editable:false,mode:"local",hiddenValue:0,value:"Support Account",store:new Ext.data.SimpleStore({fields:["lifecoversourceCode","lifecoversourceText"],data:[[0,"Support Account"],[1,"Super Fund"]]}),displayField:"lifecoversourceText",valueField:"lifecoversourceCode",listeners:{scope:this,select:function(e,c,d){Ext.Msg.alert("INCOME PROTECTION Cover Change!",'<b>You have changed where your INCOME PROTECTION Cover is taken from.<br /><br />Note:<br />This cover is <i>DIFFERENT</i> to your Life Cover.<br />Click <a href="https://www.mygcx.org/CCCAMemberPortal/file/225/Insurance_calc.xls" target="_blank">here</a> to download Income Protection Cover calculator.<br />Your Income Protection Cover is taken out annually and can be quite a large amount and can have a <i>significant</i> impact on the account it comes from.<br />So choose carefully!</b>');this.fireEvent("financialdataupdated",this,e,d,false)},render:function(d){Ext.QuickTips.register({target:d.getEl(),text:'Nominate where your Income Protection Cover should be taken from.<br /><b>This cover is <i>DIFFERENT</i> to your Life Cover.</b><br />Click <a href="https://www.mygcx.org/CCCAMemberPortal/file/225/Insurance_calc.xls" target="_blank">here</a> to download Income Protection Cover calculator.<br />Your Income Protection Cover is taken out annually and can be quite a large amount and can have a <i>significant</i> impact on the account it comes from.<br />So choose carefully!'})}}}]}]},{itemId:"mmr_panel",layout:"column",defaults:{defaultType:"numberfield",bodyStyle:"padding:10px",defaults:{width:140,minValue:0,value:0}},items:[{itemId:"my",layout:"form",columnWidth:0.5,title:"My MMR",items:[{itemId:"mmr",name:"MMR",fieldLabel:"MMR",value:0,listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Please record the amount of MMR's you plan to claim."})}}}]},{itemId:"spouse",layout:"form",columnWidth:0.5,title:"Spouse MMR",items:[{itemId:"s_mmr",name:"S_MMR",fieldLabel:"MMR (Optional)",value:0,listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"Please record the amount of MMR's you plan to claim."})}}}]}]},{itemId:"international_donations_panel",layout:"form",title:"Incoming International Donations",defaultType:"numberfield",bodyStyle:"padding:10px",labelWidth:300,defaults:{width:140,minValue:0,value:0},items:[{itemId:"international_donations",name:"INTERNATIONAL_DONATIONS",fieldLabel:"Incoming International Donations",listeners:{scope:this,render:function(d){Ext.QuickTips.register({target:d.getEl(),text:"This is the amount that comes into your CCCA account from any CCC account outside of Australia (eg your CCCI account, if you have one.)"})}}}]},new tmn.view.InternalTransfers()]};tmn.view.FinancialDetailsForm.superclass.constructor.call(this,this.config);this.getForm().items.each(function(e,c,d){if(e.cls===undefined){e.enableKeyEvents=true;e.on("keyup",function(g,f){this.fireEvent("financialdataupdated",this,g,g.getValue(),this.processingAllowed);this.saved=false},this,{buffer:this.keyup_timeout})}},this)};Ext.extend(tmn.view.FinancialDetailsForm,Ext.FormPanel,{isSaved:function(){return(this.saved&&this.getComponent("internal_transfers_panel").isSaved())},sessionIsLocked:function(){var a=this.getTopToolbar().items.map.session_combo.getStore();var b=a.getAt(a.find("SESSION_ID",this.getSession()+""));if(b!==undefined){if(b.data.LOCKED=="true"||b.data.LOCKED=="TRUE"||b.data.LOCKED=="True"||b.data.LOCKED==true){return true}else{return false}}else{return false}},lock:function(){Ext.MessageBox.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Warning!",msg:"This session is Locked because it has been submitted. You can't save your changes to this session or delete this session. If you would like to save changes to this session, please use Save As to save a new version of the session."});this.getTopToolbar().items.map.save_session_button.disable();this.getTopToolbar().items.map.delete_session_button.disable();this.locked=true},unlock:function(){this.getTopToolbar().items.map.save_session_button.enable();this.getTopToolbar().items.map.delete_session_button.enable();this.locked=false},getSelectedSession:function(){var a=this.getTopToolbar().items.map.session_combo.getValue();if(!(a===undefined||a==null||a=="")){return this.getTopToolbar().items.map.session_combo.getValue()}else{return this.getSession()}},setSelectedSession:function(a){a+="";this.getTopToolbar().items.map.session_combo.setValue(a)},getSession:function(){return this.session_id},setSession:function(b){var c=this.getTopToolbar().items.map.session_combo.getStore(),a=c.find("SESSION_ID",b+"");if(a>=0){this.setSessionName(c.getAt(a).data.SESSION_NAME)}this.session_id=b;this.getComponent("internal_transfers_panel").setSession(b);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"session_id"}},b,false)},getSessionName:function(){return this.session_name},setSessionName:function(a){this.session_name=a;this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"session_name"}},a,false)},nameAlreadyExists:function(a){var b=this.getTopToolbar().items.map.session_combo.getStore();if(b.findExact("SESSION_NAME",a)>=0){return true}else{return false}},hasSpouse:function(){return this.spouse},setSpouse:function(a){this.spouse=a},isOverseas:function(){return this.overseas},setOverseas:function(a){this.overseas=a},enableStartDate:function(){this.getForm().items.map.os_assignment_start_date.enable()},disableStartDate:function(a){this.getForm().items.map.os_assignment_start_date.disable()},endDate:function(){return this.getForm().items.map.os_assignment_end_date},doSingleLayout:function(){var a=this.getComponent("taxable_income_panel");a.getComponent("spouse").hide();a.getComponent("my").columnWidth=1;a=this.getComponent("mfb_panel");a.getComponent("spouse").hide();a.getComponent("my").columnWidth=1;a=this.getComponent("os_lafha_panel");a.getComponent("spouse").hide();a.getComponent("my").columnWidth=1;a=this.getComponent("super_panel");a.getComponent("spouse").hide();a.getComponent("my").columnWidth=1;a=this.getComponent("mmr_panel");a.getComponent("spouse").hide();a.getComponent("my").columnWidth=1;this.form.items.each(function(d,b,c){if(d.getItemId().substr(0,2)=="s_"){d.disable()}});this.doLayout()},doMarriedLayout:function(){var a=this.getComponent("taxable_income_panel");a.getComponent("my").columnWidth=0.5;a.getComponent("spouse").show();a=this.getComponent("mfb_panel");a.getComponent("my").columnWidth=0.5;a.getComponent("spouse").show();a=this.getComponent("os_lafha_panel");a.getComponent("my").columnWidth=0.5;a.getComponent("spouse").show();a=this.getComponent("super_panel");a.getComponent("my").columnWidth=0.5;a.getComponent("spouse").show();a=this.getComponent("mmr_panel");a.getComponent("my").columnWidth=0.5;a.getComponent("spouse").show();this.form.items.each(function(d,b,c){if(d.getItemId().substr(0,2)=="s_"){d.enable()}});this.doLayout()},doOverseasLayout:function(){this.getComponent("housing_panel").items.each(function(c,a,b){c.disable()});this.getComponent("housing_panel").hide();this.getComponent("mfb_panel").getComponent("my").items.each(function(c,a,b){c.disable()});if(this.hasSpouse()){this.getComponent("mfb_panel").getComponent("spouse").items.each(function(c,a,b){c.disable()})}this.getComponent("mfb_panel").hide();this.getComponent("os_overseas_housing_panel").items.each(function(c,a,b){c.disable()});this.getComponent("os_overseas_housing_panel").hide();this.getComponent("super_panel").getComponent("my").getComponent("future_investment_panel").hide();this.getForm().items.map.future_investment_mode.setValue(0);this.getComponent("super_panel").getComponent("spouse").getComponent("future_investment_panel").hide();this.getForm().items.map.s_future_investment_mode.setValue(0);this.getComponent("taxable_income_panel").getComponent("os_residency").show();this.getComponent("os_assignment_panel").show();this.getComponent("os_assignment_panel").items.each(function(c,a,b){c.enable()});if(this.getForm().items.map.os_resident_for_tax_purposes.getValue()==1){this.getComponent("os_lafha_panel").show();this.getComponent("os_lafha_panel").getComponent("my").items.each(function(c,a,b){c.enable()});if(this.hasSpouse()){this.getComponent("os_lafha_panel").getComponent("spouse").items.each(function(c,a,b){c.enable()})}}else{this.getForm().items.map.os_lafha.setValue(0);this.getComponent("os_lafha_panel").getComponent("my").items.each(function(c,a,b){c.disable()});if(this.hasSpouse()){this.getComponent("os_lafha_panel").getComponent("spouse").items.each(function(c,a,b){c.disable()})}this.getComponent("os_lafha_panel").hide()}},doHomeAssignmentLayout:function(){this.getComponent("os_lafha_panel").getComponent("my").items.each(function(c,a,b){c.disable()});if(this.hasSpouse()){this.getComponent("os_lafha_panel").getComponent("spouse").items.each(function(c,a,b){c.disable()})}this.getComponent("os_lafha_panel").hide();this.getComponent("taxable_income_panel").getComponent("os_residency").show();this.getComponent("os_assignment_panel").show();this.getComponent("os_assignment_panel").items.each(function(c,a,b){c.enable()});this.getComponent("housing_panel").show();this.getComponent("housing_panel").items.each(function(c,a,b){c.enable()});this.getComponent("mfb_panel").show();this.getComponent("mfb_panel").getComponent("my").items.each(function(c,a,b){c.enable()});if(this.hasSpouse()){this.getComponent("mfb_panel").getComponent("spouse").items.each(function(c,a,b){c.enable()})}this.getComponent("os_overseas_housing_panel").show();this.getComponent("os_overseas_housing_panel").items.each(function(c,a,b){c.enable()});this.getComponent("super_panel").getComponent("my").getComponent("future_investment_panel").show();this.getComponent("super_panel").getComponent("spouse").getComponent("future_investment_panel").show()},doAussieLayout:function(){this.getComponent("taxable_income_panel").getComponent("os_residency").hide();this.getComponent("os_assignment_panel").items.each(function(c,a,b){c.disable()});this.getComponent("os_assignment_panel").hide();this.getComponent("os_lafha_panel").getComponent("my").items.each(function(c,a,b){c.disable()});if(this.hasSpouse()){this.getComponent("os_lafha_panel").getComponent("spouse").items.each(function(c,a,b){c.disable()})}this.getComponent("os_lafha_panel").hide();this.getComponent("os_overseas_housing_panel").items.each(function(c,a,b){c.disable()});this.getComponent("os_overseas_housing_panel").hide();this.getComponent("housing_panel").show();this.getComponent("housing_panel").items.each(function(c,a,b){c.enable()});this.getComponent("mfb_panel").show();this.getComponent("mfb_panel").getComponent("my").items.each(function(c,a,b){c.enable()});if(this.hasSpouse()){this.getComponent("mfb_panel").getComponent("spouse").items.each(function(c,a,b){c.enable()})}this.getComponent("super_panel").getComponent("my").getComponent("future_investment_panel").show();this.getComponent("super_panel").getComponent("spouse").getComponent("future_investment_panel").show()},loadForm:function(a){if(this.hasSpouse()){this.doMarriedLayout()}else{this.doSingleLayout()}if(!(this.getForm().items.map.housing_stipend.getValue()>0)){this.getComponent("taxable_income_panel").getComponent("my").getComponent("hs").hide()}if(!(this.getForm().items.map.s_housing_stipend.getValue()>0)){this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("hs").hide()}if(!(this.getForm().items.map.taxable_future_investment.getValue()>0)){this.getComponent("taxable_income_panel").getComponent("my").getComponent("fi").hide()}if(!(this.getForm().items.map.s_taxable_future_investment.getValue()>0)){this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("fi").hide()}if(!(this.getForm().items.map.taxable_future_investment.getValue()>0)||!(this.getForm().items.map.housing_stipend.getValue()>0)){this.getComponent("taxable_income_panel").getComponent("my").getComponent("ns").hide()}if(!(this.getForm().items.map.s_taxable_future_investment.getValue()>0)||!(this.getForm().items.map.s_housing_stipend.getValue()>0)){this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("ns").hide()}if(!(this.getForm().items.map.additional_mortgage.getValue()>0)){this.getComponent("housing_panel").getComponent("am").hide()}if(this.isOverseas()){if(this.home_assignment==true){this.doHomeAssignmentLayout()}else{this.doOverseasLayout()}}else{this.doAussieLayout()}if(this.getSession()!==undefined&&this.getSession()!=""&&this.getSession()!=null){this.fireEvent("loadsession",this);this.getComponent("internal_transfers_panel").loadInternalTransfers(this.getSession())}else{this.fireEvent("resetsession",this)}},onLoadSuccess:function(a,b){for(fieldCount=0;fieldCount<a.items.length;fieldCount++){if(!isNaN(parseInt(a.items.items[fieldCount].getValue()))){a.items.items[fieldCount].setValue(parseInt(a.items.items[fieldCount].getValue()))}}this.fireEvent("financialdataupdated",this,a.items.map.os_resident_for_tax_purposes,a.items.map.os_resident_for_tax_purposes.getValue(),false);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"home_assignment"}},this.home_assignment,false);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"pre_tax_super_mode"}},"auto",false);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"s_pre_tax_super_mode"}},"auto",false);this.fireEvent("financialdataupdated",this,a.items.map.mfb_rate,a.items.map.mfb_rate.getValue(),false);this.fireEvent("financialdataupdated",this,a.items.map.s_mfb_rate,a.items.map.s_mfb_rate.getValue(),false)},onLoadFailure:function(a,b){if(b.failureType===Ext.form.Action.CONNECT_FAILURE){Ext.MessageBox.alert("Server Error",'Could Not Connect to Server! Please Contact The Technology Team at <a href="mailto:tech.team@ccca.org.au">tech.team@ccca.org.au</a>');return}for(fieldCount=0;fieldCount<a.items.length;fieldCount++){if(!isNaN(parseInt(a.items.items[fieldCount].getValue()))){a.items.items[fieldCount].setValue(parseInt(a.items.items[fieldCount].getValue()))}}this.fireEvent("financialdataupdated",this,a.items.map.os_resident_for_tax_purposes,a.items.map.os_resident_for_tax_purposes.getValue(),false);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"home_assignment"}},this.home_assignment,false);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"pre_tax_super_mode"}},"auto",false);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"s_pre_tax_super_mode"}},"auto",false);this.fireEvent("financialdataupdated",this,a.items.map.mfb_rate,a.items.map.mfb_rate.getValue(),false);this.fireEvent("financialdataupdated",this,a.items.map.s_mfb_rate,a.items.map.s_mfb_rate.getValue(),false)},submitForm:function(){tmn.view.LastTMN.hide();this.form.submit({url:this.submit_url,params:{session:this.getSession(),aussie_form:this.aussie_form,overseas_form:this.overseas_form,home_assignment:this.home_assignment},scope:this,success:function(a,b){this.fireEvent("submitsuccess",this,a,b)},failure:function(a,b){this.fireEvent("submitfailure",this,a,b)}})},onSubmitSuccess:function(a,b){this.response=b.response.responseText},onSubmitFailure:function(a,b){switch(b.failureType){case Ext.form.Action.CLIENT_INVALID:Ext.Msg.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"User Error",msg:"Form fields may not be submitted with invalid values. The Toolbar at the top of the page has a list of errors to assist you."});this.getTopToolbar().plugins.onSubmitFailure();break;case Ext.form.Action.CONNECT_FAILURE:Ext.Msg.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Server Error",msg:'Could Not Connect to Server! Please Contact The Technology Team at <a href="mailto:tech.team@ccca.org.au">tech.team@ccca.org.au</a>'});break;case Ext.form.Action.SERVER_INVALID:if(b.result.alert!==undefined){Ext.Msg.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Server Error",msg:b.result.alert})}if(b.result.errors!==undefined){var c=this.getForm().items.map;Ext.MessageBox.show({icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,closable:false,title:"Error!",msg:"You have errors in your form, please review your numbers and try again."});for(error in b.result.errors){c[error.toLowerCase()].markInvalid(b.result.errors[error])}}break}},onProcessFinancialDataSuccess:function(d,b,c){var a=Ext.util.JSON.decode(b.responseText);var e=this.getForm().items.map;if(a.success==true||a.success=="true"){for(field in d){if(e[field.toLowerCase()]!==undefined){e[field.toLowerCase()].setValue(d[field])}}if(d.S_HOUSING_STIPEND!==undefined&&d.S_HOUSING_STIPEND>0){this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("hs").show()}else{this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("hs").hide()}if(d.S_TAXABLE_FUTURE_INVESTMENT!==undefined&&d.S_TAXABLE_FUTURE_INVESTMENT>0){this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("fi").show()}else{this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("fi").hide()}if((d.S_TAXABLE_FUTURE_INVESTMENT!==undefined&&d.S_TAXABLE_FUTURE_INVESTMENT>0)||(d.S_TAXABLE_FUTURE_INVESTMENT!==undefined&&d.S_TAXABLE_FUTURE_INVESTMENT>0)){this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("ns").show()}else{this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("ns").hide()}if(d.HOUSING_STIPEND!==undefined&&d.HOUSING_STIPEND>0){this.getComponent("taxable_income_panel").getComponent("my").getComponent("hs").show()}else{this.getComponent("taxable_income_panel").getComponent("my").getComponent("hs").hide()}if(d.TAXABLE_FUTURE_INVESTMENT!==undefined&&d.TAXABLE_FUTURE_INVESTMENT>0){this.getComponent("taxable_income_panel").getComponent("my").getComponent("fi").show()}else{this.getComponent("taxable_income_panel").getComponent("my").getComponent("fi").hide()}if((d.TAXABLE_FUTURE_INVESTMENT!==undefined&&d.TAXABLE_FUTURE_INVESTMENT>0)||(d.HOUSING_STIPEND!==undefined&&d.HOUSING_STIPEND>0)){this.getComponent("taxable_income_panel").getComponent("my").getComponent("ns").show()}else{this.getComponent("taxable_income_panel").getComponent("my").getComponent("ns").hide()}if(d.ADDITIONAL_MORTGAGE!==undefined&&d.ADDITIONAL_MORTGAGE>0){this.getComponent("housing_panel").getComponent("am").show()}else{this.getComponent("housing_panel").getComponent("am").hide()}if(d.FUTURE_INVESTMENT_MODE==0||(d.PRE_TAX_SUPER!==undefined&&d.PRE_TAX_SUPER>0)){this.getComponent("super_panel").getComponent("my").getComponent("pre_tax_super_panel").show()}else{this.getComponent("super_panel").getComponent("my").getComponent("pre_tax_super_panel").hide()}if(d.S_FUTURE_INVESTMENT_MODE==0||(d.S_PRE_TAX_SUPER!==undefined&&d.S_PRE_TAX_SUPER>0)){this.getComponent("super_panel").getComponent("spouse").getComponent("pre_tax_super_panel").show()}else{this.getComponent("super_panel").getComponent("spouse").getComponent("pre_tax_super_panel").hide()}if(a.warnings!==undefined){for(warning in a.warnings){Ext.MessageBox.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Warning!",msg:a.warnings[warning]});e[warning.toLowerCase()].markInvalid(a.warnings[warning])}}}else{for(error in a.errors){e[error.toLowerCase()].markInvalid(a.errors[error])}}},onProcessFinancialDataFailure:function(a,b){Ext.MessageBox.alert("Server Error",'Server Could Not Calculate Values! Please Contact The Technology Team at <a href="mailto:tech.team@ccca.org.au">tech.team@ccca.org.au</a>')},onLoadSession:function(b,c){var a;tmn.view.LastTMN.hide();if(this.rendered){this.el.mask("Loading")}if(c!==undefined&&c==true){a={mode:"r",form:Ext.util.JSON.encode({aussie_form:this.aussie_form,overseas_form:this.overseas_form,home_assignment:this.home_assignment}),data:Ext.util.JSON.encode(b),inflate:"true"}}else{a={mode:"r",form:Ext.util.JSON.encode({aussie_form:this.aussie_form,overseas_form:this.overseas_form,home_assignment:this.home_assignment}),data:Ext.util.JSON.encode(b)}}Ext.Ajax.request({url:this.crud_url,params:a,success:function(d,e){this.fireEvent("loadsessionsuccess",this,d,e)},failure:this.onLoadSessionFailure,scope:this})},onLoadSessionSuccess:function(b){if(b!==undefined){if(this.rendered){var a=b.session_id;this.resetForm();this.processingAllowed=false;if(b.housing_stipend!==undefined&&b.housing_stipend>0){this.getComponent("taxable_income_panel").getComponent("my").getComponent("hs").show()}else{this.getComponent("taxable_income_panel").getComponent("my").getComponent("hs").hide()}if(b.s_housing_stipend!==undefined&&b.s_housing_stipend>0){this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("hs").show()}else{this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("hs").hide()}if(b.taxable_future_investment!==undefined&&b.taxable_future_investment>0){this.getComponent("taxable_income_panel").getComponent("my").getComponent("fi").show()}else{this.getComponent("taxable_income_panel").getComponent("my").getComponent("fi").hide()}if(b.s_taxable_future_investment!==undefined&&b.s_taxable_future_investment>0){this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("fi").show()}else{this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("fi").hide()}if((b.taxable_future_investment!==undefined&&b.taxable_future_investment>0)||(b.housing_stipend!==undefined&&b.housing_stipend>0)){this.getComponent("taxable_income_panel").getComponent("my").getComponent("ns").show()}else{this.getComponent("taxable_income_panel").getComponent("my").getComponent("ns").hide()}if((b.s_taxable_future_investment!==undefined&&b.s_taxable_future_investment>0)||(b.s_housing_stipend!==undefined&&b.s_housing_stipend>0)){this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("ns").show()}else{this.getComponent("taxable_income_panel").getComponent("spouse").getComponent("ns").hide()}if(b.additional_mortgage!==undefined&&b.additional_mortgage>0){this.getComponent("housing_panel").getComponent("am").show()}else{this.getComponent("housing_panel").getComponent("am").hide()}if(b.future_investment_mode==0||(b.pre_tax_super!==undefined&&b.pre_tax_super>0)){this.getComponent("super_panel").getComponent("my").getComponent("pre_tax_super_panel").show()}else{this.getComponent("super_panel").getComponent("my").getComponent("pre_tax_super_panel").hide()}if(b.s_future_investment_mode==0||(b.s_pre_tax_super!==undefined&&b.s_pre_tax_super>0)){this.getComponent("super_panel").getComponent("spouse").getComponent("pre_tax_super_panel").show()}else{this.getComponent("super_panel").getComponent("spouse").getComponent("pre_tax_super_panel").hide()}if(b.pre_tax_super_mode!==undefined){if(b.pre_tax_super_mode=="manual"){this.getComponent("super_panel").getComponent("my").getComponent("pre_tax_super_panel").getComponent("pre_tax_super_mode").toggle(true)}else{this.getComponent("super_panel").getComponent("my").getComponent("pre_tax_super_panel").getComponent("pre_tax_super_mode").toggle(false)}}if(b.s_pre_tax_super_mode!==undefined){if(b.s_pre_tax_super_mode=="manual"){this.getComponent("super_panel").getComponent("spouse").getComponent("pre_tax_super_panel").getComponent("s_pre_tax_super_mode").toggle(true)}else{this.getComponent("super_panel").getComponent("spouse").getComponent("pre_tax_super_panel").getComponent("s_pre_tax_super_mode").toggle(false)}}if((b.super_fund!==undefined&&b.super_fund==1)){this.getComponent("super_panel").getComponent("my").getComponent("additional_life_cover_panel").expand()}else{this.getComponent("super_panel").getComponent("my").getComponent("additional_life_cover_panel").collapse()}if((b.s_super_fund!==undefined&&b.s_super_fund==1)){this.getComponent("super_panel").getComponent("spouse").getComponent("s_additional_life_cover_panel").expand()}else{this.getComponent("super_panel").getComponent("spouse").getComponent("s_additional_life_cover_panel").collapse()}for(field in b){if(this.getForm().items.map[field.toLowerCase()]!==undefined){this.getForm().items.map[field.toLowerCase()].setValue(b[field]);this.fireEvent("financialdataupdated",this,this.getForm().items.map[field.toLowerCase()],b[field],false)}else{this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return this.name},name:field},b[field],false)}}for(fieldCount=0;fieldCount<this.getForm().items.length;fieldCount++){if(!isNaN(parseInt(this.getForm().items.items[fieldCount].getValue()))){this.getForm().items.items[fieldCount].setValue(parseInt(this.getForm().items.items[fieldCount].getValue()))}}if(this.getForm().items.map.os_assignment_start_date.getValue()===undefined||this.getForm().items.map.os_assignment_start_date.getValue()==null||this.getForm().items.map.os_assignment_start_date.getValue()==""){this.getForm().items.map.os_assignment_start_date.setMaxValue(null);this.getForm().items.map.os_assignment_start_date.setMinValue(null)}else{this.getForm().items.map.os_assignment_start_date.setMaxValue(this.getForm().items.map.os_assignment_start_date.getValue());this.getForm().items.map.os_assignment_start_date.setMinValue(null)}if(this.getForm().items.map.os_assignment_end_date.getValue()===undefined||this.getForm().items.map.os_assignment_end_date.getValue()==null||this.getForm().items.map.os_assignment_end_date.getValue()==""){this.getForm().items.map.os_assignment_end_date.setMaxValue(null);this.getForm().items.map.os_assignment_end_date.setMinValue(null)}else{this.getForm().items.map.os_assignment_end_date.setMaxValue(null);this.getForm().items.map.os_assignment_end_date.setMinValue(this.getForm().items.map.os_assignment_start_date.getValue())}this.setSelectedSession(a);if(!isNaN(parseInt(a))){a=parseInt(a)}this.setSession(a);if(this.sessionIsLocked()){this.lock()}else{this.unlock()}this.getComponent("internal_transfers_panel").loadInternalTransfers(this.getSession());this.processingAllowed=true;this.saved=true}else{this.setSession(b.session_id)}}if(this.rendered){this.el.unmask()}},onLoadSessionFailure:function(a,b){Ext.MessageBox.alert("Message","Load Failure, Try Again!");if(this.rendered){this.el.unmask()}},onSaveAsSession:function(a){if(this.rendered){this.el.mask("Saving Session: "+this.getSessionName())}Ext.Ajax.request({url:this.crud_url,params:{mode:"c",form:Ext.util.JSON.encode({aussie_form:this.aussie_form,overseas_form:this.overseas_form,home_assignment:this.home_assignment}),data:Ext.util.JSON.encode(a)},success:function(b,c){this.fireEvent("saveassessionsuccess",this,b,c)},failure:this.onSaveSessionFailure,scope:this})},saveAsInternalTransfers:function(a){this.getComponent("internal_transfers_panel").saveAsInternalTransfers(a)},onSaveAsSessionSuccess:function(a){this.onSaveSessionSuccess()},onSaveSession:function(a){if(this.rendered){this.el.mask("Saving")}Ext.Ajax.request({url:this.crud_url,params:{mode:"u",form:Ext.util.JSON.encode({aussie_form:this.aussie_form,overseas_form:this.overseas_form,home_assignment:this.home_assignment}),data:Ext.util.JSON.encode(a)},success:this.onSaveSessionSuccess,failure:this.onSaveSessionFailure,scope:this});this.getComponent("internal_transfers_panel").saveInternalTransfers()},onSaveSessionSuccess:function(){if(this.sessionIsLocked()){this.lock()}else{this.unlock()}if(this.rendered){this.el.unmask()}this.saved=true},reloadSessionCombo:function(){this.getTopToolbar().items.map.session_combo.getStore().reload({callback:function(){if(this.getSession()!=null){this.setSelectedSession(this.getSession())}else{this.getTopToolbar().items.map.session_combo.clearValue()}},scope:this})},onSaveSessionFailure:function(a,b){Ext.MessageBox.alert("Message","Save Failure, Try Again!");if(this.rendered){this.el.unmask()}},onDeleteSession:function(a){tmn.view.LastTMN.hide();if(this.rendered){this.el.mask("Deleting")}this.getComponent("internal_transfers_panel").deleteInternalTransfers();Ext.Ajax.request({url:this.crud_url,params:{mode:"d",form:Ext.util.JSON.encode({aussie_form:this.aussie_form,overseas_form:this.overseas_form,home_assignment:this.home_assignment}),data:Ext.util.JSON.encode(a)},success:function(b,c){this.fireEvent("deletesessionsuccess",this,b,c)},failure:this.onDeleteSessionFailure,scope:this})},onDeleteSessionSuccess:function(a,b){this.getTopToolbar().items.map.session_combo.getStore().reload();this.resetForm();if(this.rendered){this.el.unmask()}this.saved=true},onDeleteSessionFailure:function(a,b){Ext.MessageBox.alert("Message","Delete Failure, try again!");if(this.rendered){this.el.unmask()}},resetForm:function(){this.fireEvent("resetfinancialdata",this);this.getForm().items.map.os_assignment_start_date.setMaxValue(null);this.getForm().items.map.os_assignment_start_date.setMinValue(null);this.getForm().items.map.os_assignment_end_date.setMaxValue(null);this.getForm().items.map.os_assignment_end_date.setMinValue(null);for(fieldCount=0;fieldCount<this.getForm().items.length;fieldCount++){this.getForm().items.items[fieldCount].reset()}this.fireEvent("financialdataupdated",this,this.getForm().items.map.os_resident_for_tax_purposes,1,false);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"home_assignment"}},this.home_assignment,false);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"pre_tax_super_mode"}},"auto",false);this.fireEvent("financialdataupdated",this,{isValid:function(){return true},getName:function(){return"s_pre_tax_super_mode"}},"auto",false);this.fireEvent("financialdataupdated",this,this.getForm().items.map.mfb_rate,2,false);this.fireEvent("financialdataupdated",this,this.getForm().items.map.s_mfb_rate,2,false);this.getTopToolbar().items.map.session_combo.clearValue();this.setSession(null);this.setSessionName(null);this.getComponent("internal_transfers_panel").resetInternalTransfers();this.saved=false;this.unlock()}});Ext.ns("tmn","tmn.view");tmn.view.PersonalDetailsForm=function(a,b){this.view=a||{};b=b||{};this.nameStore=new Ext.data.JsonStore({itemId:"name_store",root:"data",url:"php/imp/namefill.php",fields:["ID","FIRSTNAME","SURNAME","MINISTRY"],autoLoad:{params:{mode:"all"}}});this.ministry_combo_store=new Ext.data.JsonStore({itemId:"ministry_store",root:"Ministry",fields:["MINISTRY_ID","MINISTRY_LEVY"],url:"php/imp/combofill.php",autoLoad:{params:{mode:"Ministry"}}});this.id=b.id||"personal_details_form";this.title=b.title||"Personal Details";this.load_url=b.load_url||"php/personal_details.php";this.submit_url=b.submit_url||"php/personal_details.php";this.aussie_form;this.overseas_form;(b.aussie_form===undefined)?this.aussie_form=true:this.aussie_form=b.aussie_form;(b.overseas_form===undefined)?this.overseas_form=true:this.overseas_form=b.overseas_form;this.spouse="";this.overseas="";this.addEvents("single","married","overseas","aussie","mpdyes","mpdno","fulltime","parttime","loadsuccess","loadfailure","submitsuccess","submitfailure");this.config={id:this.id,frame:true,buttonAlign:"right",title:this.title,layout:"column",defaults:{defaultType:"textfield"},items:[{itemId:"personal_details",title:"My Personal Details",layout:"form",columnWidth:0.5,labelWidth:240,bodyStyle:"padding:10px",defaultType:"textfield",items:[{itemId:"first",fieldLabel:"First Name",name:"FIRSTNAME",readOnly:true,allowBlank:false,width:150,listeners:{focus:function(c){c.blur()}}},{fieldLabel:"Last Name",name:"SURNAME",readOnly:true,allowBlank:false,width:150,listeners:{focus:function(c){c.blur()}}},{itemId:"ministry",xtype:"combo",width:150,fieldLabel:"Ministry",valueField:"MINISTRY_ID",hiddenName:"MINISTRY",hiddenId:"MINISTRY",displayField:"MINISTRY_ID",triggerAction:"all",editable:false,forceSelection:true,allowBlank:false,mode:"local",store:this.ministry_combo_store},{itemId:"ftptos",xtype:"combo",width:150,fieldLabel:"Are you Full Time, Part Time Or Overseas?",name:"FT_PT_OS",hiddenName:"FT_PT_OS",hiddenId:"FT_PT_OS_hidden",value:0,triggerAction:"all",editable:false,mode:"local",store:new Ext.data.SimpleStore({fields:["ftptosCode","ftptosName"],data:[[0,"Full Time"],[1,"Part Time"],[2,"Overseas"]]}),displayField:"ftptosName",valueField:"ftptosCode",listeners:{select:function(e,c,d){switch(d){case 0:this.fireEvent("fulltime",this,false);break;case 1:this.fireEvent("parttime",this,false);break;case 2:this.fireEvent("overseas",this,false);break}},scope:this}},{itemId:"days_per_week",xtype:"panel",layout:"form",labelWidth:240,defaults:{width:150},items:[{itemId:"daysperwk",xtype:"combo",fieldLabel:"How many days per week do you work?",name:"DAYS_PER_WEEK",hiddenName:"DAYS_PER_WEEK",hiddenId:"DAYS_PER_WEEK_hidden",triggerAction:"all",emptyText:"Enter Days Per Week...",validationEvent:"blur",allowBlank:false,editable:false,mode:"local",store:new Ext.data.SimpleStore({fields:["daysperwkCode","daysperwkName"],data:[[0,"One Day per Week"],[1,"Two Days per Week"],[2,"Three Days per Week"],[3,"Four Days per Week"]]}),displayField:"daysperwkName",valueField:"daysperwkCode"}]}]},{itemId:"s_personal_details",title:"Spouse Personal Details",layout:"form",columnWidth:0.5,labelWidth:240,bodyStyle:"padding:10px",defaultType:"textfield",items:[{itemId:"s_first",xtype:"combo",width:150,fieldLabel:"First Name",name:"S_FIRSTNAME",hiddenName:"S_FIRSTNAME",hiddenId:"S_FIRSTNAME_hidden",emptyText:"First Name...",hideTrigger:true,typeAhead:true,editable:true,forceSelection:true,mode:"local",store:this.nameStore,tpl:'<tpl for="."><div class="x-combo-list-item">{FIRSTNAME} {SURNAME} - {MINISTRY}</div></tpl>',displayField:"FIRSTNAME",valueField:"FIRSTNAME",listeners:{select:function(e,c,d){this.getForm().items.map.s_last.setValue(c.data.SURNAME)},scope:this}},{itemId:"s_last",xtype:"combo",width:150,fieldLabel:"Last Name",name:"S_SURNAME",hiddenName:"S_SURNAME",hiddenId:"S_SURNAME_hidden",emptyText:"Last Name...",hideTrigger:true,typeAhead:true,editable:true,forceSelection:true,mode:"local",store:this.nameStore,tpl:'<tpl for="."><div class="x-combo-list-item">{FIRSTNAME} {SURNAME} - {MINISTRY}</div></tpl>',displayField:"SURNAME",valueField:"SURNAME",listeners:{select:function(e,c,d){this.getForm().items.map.s_first.setValue(c.data.FIRSTNAME)},scope:this}},{itemId:"s_ministry",xtype:"combo",width:150,fieldLabel:"Ministry",valueField:"MINISTRY_ID",hiddenName:"S_MINISTRY",hiddenId:"S_MINISTRY",displayField:"MINISTRY_ID",triggerAction:"all",editable:false,forceSelection:true,mode:"local",store:this.ministry_combo_store},{itemId:"s_ftptos",xtype:"combo",width:150,fieldLabel:"Are you Full Time, Part Time Or Overseas?",name:"S_FT_PT_OS",hiddenName:"S_FT_PT_OS",hiddenId:"S_FT_PT_OS_hidden",value:0,triggerAction:"all",editable:false,mode:"local",store:new Ext.data.SimpleStore({fields:["ftptosCode","ftptosName"],data:[[0,"Full Time"],[1,"Part Time"],[2,"Overseas"]]}),displayField:"ftptosName",valueField:"ftptosCode",listeners:{select:function(e,c,d){switch(d){case 0:this.fireEvent("fulltime",this,true);break;case 1:this.fireEvent("parttime",this,true);break;case 2:this.fireEvent("overseas",this,true);break}},scope:this}},{itemId:"s_days_per_week",xtype:"panel",layout:"form",labelWidth:240,defaults:{width:150},items:[{itemId:"s_daysperwk",xtype:"combo",fieldLabel:"How many days per week do you work?",name:"S_DAYS_PER_WEEK",hiddenName:"S_DAYS_PER_WEEK",hiddenId:"S_DAYS_PER_WEEK_hidden",triggerAction:"all",emptyText:"Enter Days Per Week...",validationEvent:"blur",editable:false,mode:"local",store:new Ext.data.SimpleStore({fields:["daysperwkCode","daysperwkName"],data:[[0,"One Day per Week"],[1,"Two Days per Week"],[2,"Three Days per Week"],[3,"Four Days per Week"]]}),displayField:"daysperwkName",valueField:"daysperwkCode"}]}]},{itemId:"mpd_details",title:"MPD Details",layout:"form",columnWidth:1,labelWidth:240,bodyStyle:"padding:10px",defaultType:"textfield",items:[{itemId:"mpd",xtype:"combo",width:150,fieldLabel:"Are you an NMA or currently doing MPD?",name:"MPD",hiddenName:"MPD",hiddenId:"MPD_hidden",triggerAction:"all",emptyText:"Enter Yes or No...",validationEvent:"blur",allowBlank:false,editable:false,mode:"local",store:new Ext.data.SimpleStore({fields:["mpdCode","mpdName"],data:[[0,"No"],[1,"Yes"]]}),displayField:"mpdName",valueField:"mpdCode",listeners:{select:function(e,c,d){switch(d){case 0:this.fireEvent("mpdno",this);break;case 1:this.fireEvent("mpdyes",this);break}},scope:this}},{itemId:"mpd_supervisor",xtype:"panel",layout:"form",labelWidth:240,defaultType:"textfield",defaults:{width:150},items:[{itemId:"mpd_supervisor_first",xtype:"combo",width:150,fieldLabel:"MPD Supervisor First Name",name:"M_FIRSTNAME",hiddenName:"M_FIRSTNAME",hiddenId:"M_FIRSTNAME_hidden",emptyText:"First Name...",allowBlank:false,hideTrigger:true,typeAhead:true,editable:true,forceSelection:true,mode:"local",store:this.nameStore,tpl:'<tpl for="."><div class="x-combo-list-item">{FIRSTNAME} {SURNAME} - {MINISTRY}</div></tpl>',displayField:"FIRSTNAME",valueField:"FIRSTNAME",listeners:{select:function(e,c,d){this.getForm().items.map.mpd_supervisor_last.setValue(c.data.SURNAME)},scope:this}},{itemId:"mpd_supervisor_last",xtype:"combo",width:150,fieldLabel:"MPD Supervisor Last Name",name:"M_SURNAME",hiddenName:"M_SURNAME",hiddenId:"M_SURNAME_hidden",emptyText:"Last Name...",allowBlank:false,hideTrigger:true,typeAhead:true,editable:true,forceSelection:true,mode:"local",store:this.nameStore,tpl:'<tpl for="."><div class="x-combo-list-item">{FIRSTNAME} {SURNAME} - {MINISTRY}</div></tpl>',displayField:"SURNAME",valueField:"SURNAME",listeners:{select:function(e,c,d){this.getForm().items.map.mpd_supervisor_first.setValue(c.data.FIRSTNAME)},scope:this}}]}]}]};tmn.view.PersonalDetailsForm.superclass.constructor.call(this,this.config)};Ext.extend(tmn.view.PersonalDetailsForm,Ext.FormPanel,{hasSpouse:function(){if(this.spouse==""){return(!(this.getForm().items.map.s_first.getValue()==""||this.getForm().items.map.s_first.getValue()==null)&&!(this.getForm().items.map.s_last.getValue()==""||this.getForm().items.map.s_last.getValue()==null))}else{return this.spouse}},setSpouse:function(a){this.spouse=a},isOverseas:function(){return this.overseas},setOverseas:function(a){this.overseas=a},getFtptosValue:function(){switch(this.getForm().items.map.ftptos.getValue()){case 0:return"Full Time";case 1:return"Part Time";case 2:return"Overseas";default:return""}},getSpouseFtptosValue:function(){switch(this.getForm().items.map.s_ftptos.getValue()){case 0:return"Full Time";case 1:return"Part Time";case 2:return"Overseas";default:return""}},copyFtptosValue:function(){this.getForm().items.map.s_ftptos.setValue(this.getForm().items.map.ftptos.getValue())},copySpouseFtptosValue:function(){this.getForm().items.map.ftptos.setValue(this.getForm().items.map.s_ftptos.getValue())},setMpdSupervisorVisable:function(a){if(a){this.getForm().items.map.mpd_supervisor_first.setDisabled(false);this.getForm().items.map.mpd_supervisor_last.setDisabled(false);this.getComponent("mpd_details").getComponent("mpd_supervisor").show()}else{this.getComponent("mpd_details").getComponent("mpd_supervisor").hide();this.getForm().items.map.mpd_supervisor_first.reset();this.getForm().items.map.mpd_supervisor_last.reset();this.getForm().items.map.mpd_supervisor_first.setDisabled(true);this.getForm().items.map.mpd_supervisor_last.setDisabled(true)}},setDaysPerWeekVisable:function(a){if(a){this.getForm().items.map.daysperwk.setDisabled(false);this.getComponent("personal_details").getComponent("days_per_week").show()}else{this.getComponent("personal_details").getComponent("days_per_week").hide();this.getForm().items.map.daysperwk.reset();this.getForm().items.map.daysperwk.setDisabled(true)}},setSpouseDaysPerWeekVisable:function(a){if(a){this.getForm().items.map.s_daysperwk.setDisabled(false);this.getComponent("s_personal_details").getComponent("s_days_per_week").show()}else{this.getComponent("s_personal_details").getComponent("s_days_per_week").hide();this.getForm().items.map.s_daysperwk.reset();this.getForm().items.map.s_daysperwk.setDisabled(true)}},loadForm:function(){this.load({url:this.load_url,waitMsgTarget:true,waitMsg:"Loading",params:{mode:"get"},scope:this,success:function(a,b){this.fireEvent("loadsuccess",this,a,b)},failure:function(a,b){this.fireEvent("loadfailure",this,a,b)}})},onLoadSuccess:function(a,b){for(fieldCount=0;fieldCount<a.items.length;fieldCount++){if(!isNaN(parseInt(a.items.items[fieldCount].getValue()))){a.items.items[fieldCount].setValue(parseInt(a.items.items[fieldCount].getValue()))}}switch(a.items.map.ftptos.getValue()){case 0:this.fireEvent("fulltime",this,false);break;case 1:this.fireEvent("parttime",this,false);break;case 2:this.fireEvent("overseas",this,false);break}switch(a.items.map.s_ftptos.getValue()){case 0:this.fireEvent("fulltime",this,true);break;case 1:this.fireEvent("parttime",this,true);break;case 2:this.fireEvent("overseas",this,true);break}switch(a.items.map.mpd.getValue()){case 0:this.fireEvent("mpdno",this);break;case 1:this.fireEvent("mpdyes",this);break}},onLoadFailure:function(a,b){if(b.failureType===Ext.form.Action.CONNECT_FAILURE){Ext.MessageBox.alert("Server Error","Could Not Connect to Server! Please Contact The Technology Team at tech.team@ccca.org.au")}if(b.failureType===Ext.form.Action.LOAD_FAILURE){Ext.MessageBox.alert("Database Error",'You could not be found in our Database! You are not allowed to do a TMN! Please Contact The Technology Team at <a href="mailto:tech.team@ccca.org.au">tech.team@ccca.org.au</a> if you think you should be able to.',function(){Ext.getBody().mask();window.location="http://mportal.ccca.org.au/"})}},submitForm:function(){this.form.submit({url:this.submit_url,params:{mode:"set"},scope:this,success:function(a,b){this.fireEvent("submitsuccess",this,a,b)},failure:function(a,b){this.fireEvent("submitfailure",this,a,b)}})},onSubmitSuccess:function(a,b){if(this.hasSpouse()){this.fireEvent("married")}else{this.fireEvent("single")}},onSubmitFailure:function(a,b){if(b.failureType===Ext.form.Action.CONNECT_FAILURE){Ext.MessageBox.alert("Server Error","Could Not Connect to Server! Please Contact The Technology Team at tech.team@ccca.org.au")}else{if(b.failureType===Ext.form.Action.SERVER_INVALID){if(b.result.errors.S_FIRSTNAME!==undefined){Ext.MessageBox.alert("Spouse Error",b.result.errors.S_FIRSTNAME)}if(b.result.errors.M_FIRSTNAME!==undefined){Ext.MessageBox.alert("MPD Supervisor Error",b.result.errors.M_FIRSTNAME)}}}}});Ext.ns("tmn","tmn.view");tmn.view.TmnView=function(){this.forms=[new tmn.view.PersonalDetailsForm(this),new tmn.view.FinancialDetailsForm(this,{id:"international_assignment_form",title:"International Assignment",home_assignment:false,aussie_form:false,overseas_form:true}),new tmn.view.FinancialDetailsForm(this,{id:"home_assignment_form",title:"Home Assignment",home_assignment:true,aussie_form:false,overseas_form:true}),new tmn.view.FinancialDetailsForm(this),new tmn.view.PrintForm(this)];this.active=0;this.spouse=false;this.overseas=false;this.addEvents("loadsuccess","loadfailure","submitsuccess","submitfailure","single","married","overseas","aussie","mpdyes","mpdno","fulltime","parttime","saveresponse","financialdataupdated","resetfinancialdata","loadsession","loadsessionsuccess","savesession","saveassession","saveassessionsuccess","deletesession","deletesessionsuccess","resetsession","tmnsubmitted","next","previous");for(formCount=0;formCount<this.forms.length;formCount++){this.relayEvents(this.forms[formCount],["financialdataupdated","loadsuccess","loadfailure","submitsuccess","submitfailure"])}this.relayEvents(this.forms[0],["single","married","overseas","aussie","mpdyes","mpdno","fulltime","parttime"]);for(formCount=1;formCount<4;formCount++){this.relayEvents(this.forms[formCount],["resetfinancialdata","loadsession","loadsessionsuccess","savesession","saveassession","saveassessionsuccess","deletesession","deletesessionsuccess","resetsession"])}this.relayEvents(this.forms[4],["next","tmnsubmitted"]);this.config={id:"tmn_container",frame:true,header:false,renderTo:"tmn-cont",width:900,autoScroll:true,items:[this.forms[0]],bbar:[{itemId:"prev_button",text:"Previous",scope:this,handler:function(){this.fireEvent("previous")},disabled:true},"->",{itemId:"next_button",text:"Next",scope:this,handler:function(){this.fireEvent("next")}}]};tmn.view.TmnView.superclass.constructor.call(this,this.config)};Ext.extend(tmn.view.TmnView,Ext.Panel,{changeForm:function(a){if(a>=0&&a<this.forms.length){var c=this.forms[this.active];this.active=a;var b=this.forms[a];if(c.bottomToolbar!==undefined){if(c.bottomToolbar.plugins!==undefined){if(c.bottomToolbar.plugins.getMsgEl().isVisible()){c.bottomToolbar.plugins.hideErrors()}}}if(c.el!==undefined){c.el.fadeOut({callback:function(e,d){this.add(d);e.hide();d.show();this.remove(e,false);this.doLayout();d.el.fadeIn()}.createDelegate(this,[c,b])})}}},getActiveForm:function(){return this.forms[this.active]},getFormAt:function(a){return this.forms[a]},loadActiveForm:function(a){if(a===undefined){this.forms[this.active].loadForm()}else{this.forms[this.active].loadForm(a)}},submitActiveForm:function(){this.forms[this.active].submitForm()},enablePrevious:function(){this.getBottomToolbar().items.map.prev_button.enable()},disablePrevious:function(){this.getBottomToolbar().items.map.prev_button.disable()},changePreviousText:function(a){this.getBottomToolbar().items.map.prev_button.setText(a)},enableNext:function(){this.getBottomToolbar().items.map.next_button.enable()},disableNext:function(){this.getBottomToolbar().items.map.next_button.disable()},changeNextText:function(a){this.getBottomToolbar().items.map.next_button.setText(a)},hasSpouse:function(){return this.spouse},isOverseas:function(){return this.overseas},setSpouse:function(a){this.spouse=a;for(formCount=0;formCount<this.forms.length;formCount++){this.forms[formCount].setSpouse(a)}},setOverseas:function(a){this.overseas=a;for(formCount=0;formCount<this.forms.length;formCount++){this.forms[formCount].setOverseas(a)}},indexOfFirstAussieForm:function(){for(formCount=0;formCount<this.forms.length;formCount++){if(this.forms[formCount].aussie_form==true){break}}return formCount},indexOfFirstOverseasForm:function(){for(formCount=0;formCount<this.forms.length;formCount++){if(this.forms[formCount].overseas_form==true){break}}return formCount},indexOfLastAussieForm:function(){for(formCount=this.forms.length-1;formCount>=0;formCount--){if(this.forms[formCount].aussie_form==true){break}}return formCount},indexOfLastOverseasForm:function(){for(formCount=this.forms.length-1;formCount>=0;formCount--){if(this.forms[formCount].overseas_form==true){break}}return formCount},length:function(){return this.forms.length},aussieLength:function(){var a=0;for(formCount=0;formCount<this.forms.length;formCount++){if(this.forms[formCount].aussie_form==true){a++}}return a},overseasLength:function(){var a=0;for(formCount=0;formCount<this.forms.length;formCount++){if(this.forms[formCount].overseas_form==true){a++}}return a}});Ext.BLANK_IMAGE_URL="lib/resources/images/default/s.gif";Ext.ns("tmn");tmn.TmnController=function(){return{view:null,financial_data:{},getForm:function(b){var c=null;switch(b){case"international-assignment":for(var a=0;a<this.view.length();a++){c=this.view.getFormAt(a);if(c.aussie_form==false&&c.overseas_form==true&&c.home_assignment==false){break}}break;case"home-assignment":for(var a=0;a<this.view.length();a++){c=this.view.getFormAt(a);if(c.aussie_form==false&&c.overseas_form==true&&c.home_assignment==true){break}}break;case"aussie-based":for(var a=0;a<this.view.length();a++){c=this.view.getFormAt(a);if(c.aussie_form==true&&c.overseas_form==false){break}}break;default:break}return c},getFinancialData:function(a){var b=this.getForm(a);if(b!=null){return this.financial_data[b.id]}else{return this.financial_data}},response:{},getResponse:function(a){var b=this.getForm(a);if(b!=null){return this.response[b.id]}else{return this.response}},onNext:function(){var a=this.view.getActiveForm();if(a.aussie_form&&a.overseas_form){this.view.submitActiveForm()}else{if(a.isSaved()){this.view.submitActiveForm()}else{Ext.MessageBox.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Warning!",msg:"You have unsaved changes on this page, you must save before you can continue."})}}},onPrevious:function(){index=this.view.active;if(this.overseas==true){do{index--}while(this.view.getFormAt(index).overseas_form==false);if(this.view.length==1){this.view.disablePrevious();this.view.disableNext()}else{if(index==this.view.indexOfFirstOverseasForm()){this.view.disablePrevious();this.view.enableNext()}else{this.view.enablePrevious();this.view.enableNext()}}}else{do{index--}while(this.view.getFormAt(index).aussie_form==false);if(this.view.length==1){this.view.disablePrevious();this.view.disableNext()}else{if(index==this.view.indexOfFirstAussieForm()){this.view.disablePrevious();this.view.enableNext()}else{this.view.enablePrevious();this.view.enableNext()}}}this.view.changeNextText("Next");Ext.History.add(index);this.view.changeForm(index);this.doResize()},onLoadSuccess:function(a,b,c){a.onLoadSuccess(b,c)},onLoadFailure:function(a,b,c){a.onLoadFailure(b,c)},onSubmitSuccess:function(b,c,d){var a=this.view.active;if(this.overseas==true){do{a++}while(this.view.getFormAt(a).overseas_form==false);if(this.view.length==1){this.view.disablePrevious();this.view.disableNext();this.view.changeNextText("Next");this.view.removeNextQuicktip()}else{if(a==this.view.indexOfLastOverseasForm()){this.view.enablePrevious();this.view.enableNext();this.view.changeNextText("Print")}else{this.view.enablePrevious();this.view.enableNext();this.view.changeNextText("Next")}}}else{do{a++}while(this.view.getFormAt(a).aussie_form==false);if(this.view.length==1){this.view.disablePrevious();this.view.disableNext();this.view.changeNextText("Next")}else{if(a==this.view.indexOfLastAussieForm()){this.view.enablePrevious();this.view.enableNext();this.view.changeNextText("Print")}else{this.view.enablePrevious();this.view.enableNext();this.view.changeNextText("Next")}}}b.onSubmitSuccess(c,d);this.response[b.id]=d.response.responseText;if((this.overseas==true&&a<=this.view.indexOfLastOverseasForm())||(this.overseas==false&&a<=this.view.indexOfLastAussieForm())){this.view.changeForm(a);Ext.History.add(a);if(this.view.getActiveForm().rendered){this.loadHandler(b)}else{this.view.getActiveForm().on("afterrender",this.loadHandler,this,{single:true})}}},loadHandler:function(a){if(this.view.getActiveForm().home_assignment==true){this.view.loadActiveForm(this.getFinancialData("international-assignment"));this.view.getActiveForm().disableStartDate();this.view.getActiveForm().onLoadSuccess(this.view.getActiveForm().getForm())}else{if(this.view.active==this.view.indexOfLastAussieForm()||this.view.active==this.view.indexOfLastOverseasForm()){if(this.overseas==true){this.view.getActiveForm().setSession(this.getFinancialData("international-assignment")["session_id"])}else{this.view.getActiveForm().setSession(this.getFinancialData("aussie-based")["session_id"])}this.view.loadActiveForm(this.response)}else{this.view.loadActiveForm()}}this.doResize()},onSubmitFailure:function(a,b,c){a.onSubmitFailure(b,c)},onFullTime:function(a,b){if(b){a.setSpouseDaysPerWeekVisable(false);this.onOverseas(a,true,false);if(a.getFtptosValue()=="Overseas"){a.copySpouseFtptosValue();a.fireEvent("fulltime",a,false)}}else{a.setDaysPerWeekVisable(false);this.onOverseas(a,false,false);if(a.hasSpouse()&&a.getSpouseFtptosValue()=="Overseas"){a.copyFtptosValue();a.fireEvent("fulltime",a,true)}}},onPartTime:function(a,b){if(b){a.setSpouseDaysPerWeekVisable(true);this.onOverseas(a,true,false);if(a.getFtptosValue()=="Overseas"){a.copySpouseFtptosValue();a.fireEvent("parttime",a,false)}}else{a.setDaysPerWeekVisable(true);this.onOverseas(a,false,false);if(a.hasSpouse()&&a.getSpouseFtptosValue()=="Overseas"){a.copyFtptosValue();a.fireEvent("parttime",a,true)}}},onOverseas:function(a,b,c){this.resetResponse();if(c){this.overseas=true;this.view.setOverseas(true);if(b){a.setSpouseDaysPerWeekVisable(false);a.setDaysPerWeekVisable(false);a.copySpouseFtptosValue()}else{a.setDaysPerWeekVisable(false);if(a.hasSpouse()){a.copyFtptosValue();a.setSpouseDaysPerWeekVisable(false)}}}else{this.overseas=false;this.view.setOverseas(false)}},onMpd:function(a,b){if(b){a.setMpdSupervisorVisable(true)}else{a.setMpdSupervisorVisable(false)}},onSpouse:function(a){if(a){this.spouse=true;this.view.setSpouse(true)}else{this.spouse=false;this.view.setSpouse(false)}},onLoadSession:function(c){var b={session_id:c.getSelectedSession()};if(c.aussie_form){if(c.isSaved()==true){c.onLoadSession(b,false)}else{Ext.MessageBox.confirm("Warning","Are you sure you want to load a new session without saving the last one?",function(e){if(e=="yes"){this.form.onLoadSession(this.data,false)}else{this.form.setSelectedSession(this.form.getSession())}},{form:c,data:b})}}if(c.overseas_form){var a=this.getForm("home-assignment");var d=this.getForm("international-assignment");var b={session_id:c.getSelectedSession()};if(a.isSaved()&&d.isSaved()){c.onLoadSession(b,false)}else{Ext.MessageBox.confirm("Warning","You have unsaved changes on one of your pages. Are you sure you want to load a new session without saving the last one?",function(e){if(e=="yes"){this.form.onLoadSession(this.data,false)}else{this.form.setSelectedSession(this.form.getSession())}},{form:c,data:b})}}},onLoadSessionSuccess:function(f,c,d){var b=Ext.util.JSON.decode(c.responseText),e="";if(f.aussie_form){this.financial_data[f.id]=b.data;f.onLoadSessionSuccess(this.financial_data[f.id]);e="We take inflation to be 2.5% and so we multiply your stipend, additional tax, post tax super, pre tax super and mmrs by 1.025."}if(f.overseas_form){var a=this.getForm("home-assignment");var g=this.getForm("international-assignment");this.financial_data[a.id]=b.data["home-assignment"];this.financial_data[g.id]=b.data["international-assignment"];a.onLoadSessionSuccess(this.financial_data[a.id]);g.onLoadSessionSuccess(this.financial_data[g.id]);e="We take inflation to be 2.5% and so we multiply your stipend, living away from home allowance, additional tax, post tax super, pre tax super and mmrs by 1.025."}if(b.inflation_status!==undefined){if(b.inflation_status=="applied"){Ext.MessageBox.show({icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.OK,closable:false,title:"Inflation",msg:'<b>We have increased your values for you to take inflation into account.<br />This has not been saved so if you want to go back just reload this session.</b><br /><br />If you would like to view the this session <i>WITHOUT</i> inflation, follow this link <a href="http://mportal.ccca.org.au/TMN/viewer.php?session='+f.getSession()+'" target="_blank">http://mportal.ccca.org.au/TMN/viewer.php?session='+f.getSession()+"</a>.<br /><br />Note: "+e,scope:f,fn:function(){if(this.locked){Ext.MessageBox.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Locked!",msg:"This session is Locked because it has been submitted. You can't save your changes to this session or delete this session. If you would like to save changes to this session, please use Save As to save a new version of the session."})}}});f.fireEvent("financialdataupdated",f,{isValid:function(){return true},getName:function(){return"session_id"}},f.getSession(),true)}else{if(b.inflation_status=="needed"){Ext.MessageBox.show({icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.YESNO,closable:false,title:"Inflation",msg:'<b>This session was created in a different Financial Year to this one. Due to inflation, the price of everything increases by about 2.5% each year. Would you like us to automatically increase your values by 2.5%?</b><br /><br /> This will not be saved so if you want to go back just reload this session.<br /><br />If you would like to preview your TMN <i>AFTER</i> inflation, follow this link <a href="http://mportal.ccca.org.au/TMN/viewer.php?isession='+f.getSession()+'" target="_blank">http://mportal.ccca.org.au/TMN/viewer.php?isession='+f.getSession()+"</a>.<br /><br />Note: "+e,scope:f,fn:function(i,h){var j={session_id:this.getSelectedSession()};if(i=="yes"){this.onLoadSession(j,true)}else{if(this.locked){Ext.MessageBox.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Locked!",msg:"This session is Locked because it has been submitted. You can't save your changes to this session or delete this session. If you would like to save changes to this session, please use Save As to save a new version of the session."})}}}})}}}},onSaveSession:function(c){if(c.getSession()==""||c.getSession()===undefined||c.getSession()==null){this.onSaveAsSession(c)}else{if(c.aussie_form){c.onSaveSession(this.financial_data[c.id])}if(c.overseas_form){var a=this.getForm("home-assignment");var d=this.getForm("international-assignment");var b={};b["international-assignment"]=this.financial_data[d.id];if(this.financial_data[a.id]!==undefined){b["home-assignment"]=this.financial_data[a.id]}else{b["home-assignment"]=this.financial_data[d.id]}if(b["international-assignment"]["OS_ASSIGNMENT_END_DATE"]!==undefined&&b["international-assignment"]["OS_ASSIGNMENT_END_DATE"]!=null&&b["international-assignment"]["OS_ASSIGNMENT_END_DATE"]!=""){b["home-assignment"]["OS_ASSIGNMENT_START_DATE"]=b["international-assignment"]["OS_ASSIGNMENT_END_DATE"]}c.onSaveSession(b)}}},onSaveAsSession:function(e){var c=new Date();var b=c.format("Y-m-d H:i:s");if(!(e.getSessionName()===undefined||e.getSessionName()==null)){b=e.getSessionName()+" copy"}if(e.aussie_form){var d=this.financial_data[e.id];if(d.session_id!==undefined){delete d.session_id}if(d.auth_session_id!==undefined){delete d.auth_session_id}Ext.MessageBox.prompt("Save As","Give your session a name:",function(g,h){if(g=="ok"){if(h==""||this.form.nameAlreadyExists(h)){Ext.MessageBox.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Warning",msg:"You entered a blank name or a name that already exists. Please enter another name.",scope:this,fn:function(j,i){this.controller.onSaveAsSession(this.form)}})}else{this.form.setSessionName(h);this.data.session_name=h;this.form.onSaveAsSession(this.data)}}},{controller:this,form:e,data:d},false,b)}if(e.overseas_form){var a=this.getForm("home-assignment");var f=this.getForm("international-assignment");if(this.financial_data[f.id]!==undefined){if(this.financial_data[f.id]["session_id"]!==undefined){delete (this.financial_data[f.id]["session_id"])}if(this.financial_data[f.id]["auth_session_id"]!==undefined){delete (this.financial_data[f.id]["auth_session_id"])}if(this.financial_data[f.id]["home_assignment_session_id"]!==undefined){delete (this.financial_data[f.id]["home_assignment_session_id"])}if(this.financial_data[f.id]["international_assignment_session_id"]!==undefined){delete (this.financial_data[f.id]["international_assignment_session_id"])}}var d={};d["international-assignment"]=this.financial_data[f.id];d["home-assignment"]={};for($field in d["international-assignment"]){d["home-assignment"][$field]=d["international-assignment"][$field]}if(d["international-assignment"]["OS_ASSIGNMENT_END_DATE"]!==undefined&&d["international-assignment"]["OS_ASSIGNMENT_END_DATE"]!=null&&d["international-assignment"]["OS_ASSIGNMENT_END_DATE"]!=""){d["home-assignment"]["OS_ASSIGNMENT_START_DATE"]=d["international-assignment"]["OS_ASSIGNMENT_END_DATE"]}Ext.MessageBox.prompt("Save As","Give your session a name:",function(g,h){if(g=="ok"){if(h==""||this.form.nameAlreadyExists(h)){Ext.MessageBox.show({icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK,closable:false,title:"Warning",msg:"You entered a blank name or a name that already exists. Please enter another name.",scope:this,fn:function(j,i){this.controller.onSaveAsSession(this.form)}})}else{this.home_form.setSessionName(h);this.international_form.setSessionName(h);this.data["home-assignment"]["session_name"]=h;this.data["international-assignment"]["session_name"]=h;this.form.onSaveAsSession(this.data)}}},{controller:this,form:e,home_form:a,international_form:f,data:d},false,b)}},onSaveAsSessionSuccess:function(f,b,i){var g=Ext.util.JSON.decode(b.responseText);var c=g.data;if(f.aussie_form){if(c!==undefined){if(c.session_id){f.setSession(c.session_id);f.saveAsInternalTransfers(c.session_id);f.reloadSessionCombo();f.onSaveAsSessionSuccess()}}}if(f.overseas_form){var h=this.getForm("home-assignment");var d=this.getForm("international-assignment");var c=g.data;if(c!==undefined){var a=c["home-assignment"];var e=c["international-assignment"];if(a.session_id){h.setSession(a.session_id);h.reloadSessionCombo();h.onSaveAsSessionSuccess(a.session_id)}if(e.session_id){d.setSession(e.session_id);d.reloadSessionCombo();d.onSaveAsSessionSuccess(e.session_id)}f.saveAsInternalTransfers(e.session_id)}}},onDeleteSession:function(c){var b={};if(c.getSession()==""||c.getSession()==null||c.getSession()===undefined){Ext.MessageBox.alert("Warning","A Saved Session needs to be loaded for the delete function to work. If you have no Sessions available in the combo box there is no need to delete.");return}if(c.aussie_form){b.session_id=c.getSession()}if(c.overseas_form){var a=this.getForm("home-assignment");var d=this.getForm("international-assignment");b["home-assignment"]={session_id:a.getSession()};b["international-assignment"]={session_id:d.getSession()}}Ext.MessageBox.confirm("Warning","Are you sure you want to delete this session?",function(e){if(e=="yes"){this.form.onDeleteSession(this.data)}},{form:c,data:b})},onDeleteSessionSuccess:function(d,b,c){if(d.aussie_form){d.onDeleteSessionSuccess()}if(d.overseas_form){var a=this.getForm("home-assignment");var e=this.getForm("international-assignment");a.onDeleteSessionSuccess();e.onDeleteSessionSuccess();if(d.home_assignment){this.onPrevious()}}},onResetSession:function(b){if(b.aussie_form){if(!b.isSaved()){Ext.MessageBox.confirm("Warning","Are you sure you want to clear your changes to this session?",function(d){if(d=="yes"){this.resetForm()}},b)}else{b.resetForm()}}if(b.overseas_form){var a=this.getForm("home-assignment");var c=this.getForm("international-assignment");if(!a.isSaved()||!c.isSaved()){Ext.MessageBox.confirm("Warning","Are you sure you want to clear your changes to this session?",function(d){if(d=="yes"){this.home.resetForm();this.international.resetForm();if(this.form.home_assignment){this.controller.onPrevious()}}},{controller:this,form:b,home:a,international:c})}else{a.resetForm();c.resetForm();if(b.home_assignment){this.onPrevious()}}}},resetFinancialData:function(a){this.financial_data[a.id]={}},resetResponse:function(a){this.response={}},processFinancialData:function(b,d,a,c){if(d.isValid()){if(this.financial_data[b.id]===undefined){this.financial_data[b.id]={}}this.financial_data[b.id][d.getName()]=a;this.financial_data[b.id]["overseas"]=this.overseas;this.financial_data[b.id]["spouse"]=this.spouse;this.financial_data[b.id]["home_assignment"]=b.home_assignment;if(c==true){Ext.Ajax.request({url:"php/cookie_monster.php",params:{financial_data:Ext.util.JSON.encode(this.financial_data[b.id])},success:this.onProcessFinancialDataSuccess.createDelegate(this,[b],0),failure:this.onProcessFinancialDataFailure.createDelegate(this,[b],0),scope:this})}}},onProcessFinancialDataSuccess:function(d,b,c){var a=Ext.util.JSON.decode(b.responseText);if(a.success==true||a.success=="true"){delete (this.financial_data[d.id]);this.financial_data[d.id]=a.financial_data}d.onProcessFinancialDataSuccess(this.financial_data[d.id],b,c)},onProcessFinancialDataFailure:function(c,a,b){c.onProcessFinancialDataFailure(a,b)},onTmnSubmitted:function(){Ext.each([this.getForm("aussie-based"),this.getForm("home-assignment"),this.getForm("international-assignment")],function(c,a,b){c.resetForm();c.reloadSessionCombo()},this)},onHistoryChange:function(a){if(a){index=parseInt(a);if(index<this.view.active){if(this.overseas==true){if(this.view.length==1){this.view.disablePrevious();this.view.disableNext()}else{if(index==this.view.indexOfFirstOverseasForm()){this.view.disablePrevious();this.view.enableNext()}else{this.view.enablePrevious();this.view.enableNext()}}}else{if(this.view.length==1){this.view.disablePrevious();this.view.disableNext()}else{if(index==this.view.indexOfFirstAussieForm()){this.view.disablePrevious();this.view.enableNext()}else{this.view.enablePrevious();this.view.enableNext()}}}this.view.changeNextText("Next");this.view.changeForm(index)}else{if(index>this.view.active){this.onNext();return true}}}else{Ext.MessageBox.show({animEl:this.view.header,icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.YESNO,closable:false,title:"Warning!",msg:"If you click back again, You will leave the TMN and lose your data!<br />Is this what you want to do?",scope:this,fn:function(c,b){if(c=="yes"){Ext.History.back()}if(c=="no"){Ext.History.forward()}}})}},doResize:function(){var e=Ext.getDoc().getViewSize(false).height;var d=Ext.get("fb");var a=d?d.getHeight():0;var b=e-14-a;var c=400;b=(b>c)?b:c;this.view.setHeight(b)},init:function(){var a=Ext.get("loading-mask");var b=Ext.get("loading");Ext.QuickTips.init();Ext.apply(Ext.QuickTips.getQuickTip(),{showDelay:250,dismissDelay:0,hideDelay:2000,trackMouse:false});Ext.form.Field.prototype.msgTarget="side";Ext.History.init();Ext.History.add("0");Ext.History.on("change",this.onHistoryChange,this);this.view=new tmn.view.TmnView;Ext.EventManager.onWindowResize(this.doResize,this);this.doResize();this.view.on("next",this.onNext,this);this.view.on("previous",this.onPrevious,this);this.view.on("loadsuccess",this.onLoadSuccess,this);this.view.on("loadfailure",this.onLoadFailure,this);this.view.on("submitsuccess",this.onSubmitSuccess,this);this.view.on("submitfailure",this.onSubmitFailure,this);this.view.on("single",this.onSpouse.createDelegate(this,[false]),this);this.view.on("married",this.onSpouse.createDelegate(this,[true]),this);this.view.on("aussie",this.onOverseas.createDelegate(this,[false],true),this);this.view.on("overseas",this.onOverseas.createDelegate(this,[true],true),this);this.view.on("fulltime",this.onFullTime,this);this.view.on("parttime",this.onPartTime,this);this.view.on("mpdyes",this.onMpd.createDelegate(this,[true],true),this);this.view.on("mpdno",this.onMpd.createDelegate(this,[false],true),this);this.view.on("resetfinancialdata",this.resetFinancialData,this);this.view.on("financialdataupdated",this.processFinancialData,this);this.view.on("loadsession",this.onLoadSession,this);this.view.on("loadsessionsuccess",this.onLoadSessionSuccess,this);this.view.on("savesession",this.onSaveSession,this);this.view.on("saveassession",this.onSaveAsSession,this);this.view.on("saveassessionsuccess",this.onSaveAsSessionSuccess,this);this.view.on("deletesession",this.onDeleteSession,this);this.view.on("deletesessionsuccess",this.onDeleteSessionSuccess,this);this.view.on("resetsession",this.onResetSession,this);this.view.on("tmnsubmitted",this.onTmnSubmitted,this);this.view.loadActiveForm();b.fadeOut({duration:0.2,remove:true});a.setOpacity(1);a.shift({xy:b.getXY(),width:b.getWidth(),height:b.getHeight(),remove:true,duration:1.1,opacity:0.1,easing:"easeOut"})}}}();Ext.onReady(tmn.TmnController.init,tmn.TmnController);